<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>RUVseq-edgeR paired analysis of ALL samples</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">amnio-cell-free-RNA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">RUVseq-edgeR paired analysis of ALL samples</h1>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-11-24
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>amnio-cell-free-RNA/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200224code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20200224)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200224code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200224)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsatlassianpetermacorgaubitbucketscmosamniocellfreernatreed2811a12a853235f13f1a6eaad69aebe82fe44e8targetblankd2811a1a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/tree/d2811a12a853235f13f1a6eaad69aebe82fe44e8" target="_blank">d2811a1</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsatlassianpetermacorgaubitbucketscmosamniocellfreernatreed2811a12a853235f13f1a6eaad69aebe82fe44e8targetblankd2811a1a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/tree/d2811a12a853235f13f1a6eaad69aebe82fe44e8" target="_blank">d2811a1</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    .bpipe/
    Ignored:    analysis/obsolete_analysis/
    Ignored:    code/.bpipe/
    Ignored:    code/.rnaseq-test.groovy.swp
    Ignored:    code/obsolete_analysis/
    Ignored:    data/.bpipe/
    Ignored:    data/190717_A00692_0021_AHLLHFDSXX/
    Ignored:    data/190729_A00692_0022_AHLLHFDSXX/
    Ignored:    data/190802_A00692_0023_AHLLHFDSXX/
    Ignored:    data/200612_A00692_0107_AHN3YCDMXX.tar
    Ignored:    data/200612_A00692_0107_AHN3YCDMXX/
    Ignored:    data/200626_A00692_0111_AHNJH7DMXX.tar
    Ignored:    data/200626_A00692_0111_AHNJH7DMXX/
    Ignored:    data/CMV-AF-database-corrected-oct-2020.csv
    Ignored:    data/CMV-AF-database-final-included-samples.csv
    Ignored:    data/GONE4.10.13.txt
    Ignored:    data/HK_exons.csv
    Ignored:    data/HK_exons.txt
    Ignored:    data/HK_genes.txt
    Ignored:    data/IPA molecule summary.xls
    Ignored:    data/IPA-molecule-summary.csv
    Ignored:    data/brain-development-geneset.txt
    Ignored:    data/deduped_rRNA_coverage.txt
    Ignored:    data/gene-transcriptome-analysis/
    Ignored:    data/hg38_rRNA.bed
    Ignored:    data/hg38_rRNA.saf
    Ignored:    data/ignore-overlap-mapping/
    Ignored:    data/ignore/
    Ignored:    data/joindata.csv
    Ignored:    data/metadata.csv
    Ignored:    data/rds/
    Ignored:    data/salmon-pilot-analysis/
    Ignored:    data/samples.csv
    Ignored:    data/star-genome-analysis/
    Ignored:    output/c2Ens.RData
    Ignored:    output/c5Ens.RData
    Ignored:    output/hEns.RData
    Ignored:    output/keggEns.RData
    Ignored:    output/obsolete_output/

Untracked files:
    Untracked:  code/est-rRNA-cont.groovy
    Untracked:  output/star-fc-limma-voom-no_us_ab.csv

Unstaged changes:
    Modified:   .gitignore

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/STAR-FC-RUV-all.Rmd</code>) and HTML (<code>docs/STAR-FC-RUV-all.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d2811a12a853235f13f1a6eaad69aebe82fe44e8/analysis/STAR-FC-RUV-all.Rmd" target="_blank">d2811a1</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-11-24
</td>
<td>
wflow_publish(files = paste0(“analysis/”, list.files(“analysis/”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/ccd6c80f45830e95d6c0241a7327a5d05b801661/docs/STAR-FC-RUV-all.html" target="_blank">ccd6c80</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-10-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/02eba43280dae22d20df6c576303952b5f929127/analysis/STAR-FC-RUV-all.Rmd" target="_blank">02eba43</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-10-29
</td>
<td>
wflow_publish(c(“analysis/index.Rmd”, “analysis/STAR-FC-all.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/77ba079a747c0de04c91e94e3129beb7d7c4ee4b/docs/STAR-FC-RUV-all.html" target="_blank">77ba079</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-09-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/e20c62d21447b7a1e31bb69f57e0e415e80bcf8a/analysis/STAR-FC-RUV-all.Rmd" target="_blank">e20c62d</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-09-25
</td>
<td>
wflow_publish(c(“analysis/index.Rmd”, “analysis/salmon-limma-voom.Rmd”,
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/2b6479ab40b7e78b559ce7d3912860d1423a98ca/analysis/STAR-FC-RUV-all.Rmd" target="_blank">2b6479a</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-07-26
</td>
<td>
Move/remove olds files.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/STAR-FC-RUV-all.html" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d32e63b606d16b69ae5c35eae7e7615e92ac90c3/analysis/STAR-FC-RUV-all.Rmd" target="_blank">d32e63b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
<td>
wflow_publish(c(“analysis/STAR-FC-all.Rmd”, “analysis/STAR-FC-exclude-US-ab.Rmd”,
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<pre class="r"><code>library(here)
library(tidyverse)
library(EnsDb.Hsapiens.v86)
library(readr)
library(limma)
library(edgeR)
library(NMF)
library(patchwork)
library(EGSEA)
library(RUVSeq)
source(here(&quot;code/output.R&quot;))</code></pre>
<p>The data showed some adapter contamination and sequence duplication issues. Adapters were removed using <code>Trimmomatic</code> and both paired and unpaired reads were retained. Only paired reads were initially mapped with <code>Star</code> in conjunction with <code>GRCh38</code> and <code>gencode_v34</code> to detect all junctions, across all samples. Paired and unpaired reads were then mapped to <code>GRCh38</code> separately using <code>Star</code>. Duplicates were removed from paired and unpaired mapped data using <code>Picard MarkDuplicates</code>. Reads were then counted across features from <code>gencode_v34</code> using <code>featureCounts</code>.</p>
<div id="data-import" class="section level1">
<h1>Data import</h1>
<p>Set up <code>DGElist</code> object for downstream analysis. Sum paired and unpaired counts prior to downstream analysis.</p>
<pre class="r"><code>rawPE &lt;- read_delim(here(&quot;data/star-genome-analysis/counts-pe/counts.txt&quot;), 
                    delim = &quot;\t&quot;, skip = 1)
rawSE &lt;- read_delim(here(&quot;data/star-genome-analysis/counts-se/counts.txt&quot;), 
                    delim = &quot;\t&quot;, skip = 1)
samps &lt;- strsplit2(colnames(rawPE)[c(7:ncol(rawPE))], &quot;_&quot;)[,5]
batch &lt;- factor(strsplit2(colnames(rawPE)[c(7:ncol(rawPE))], 
                                     &quot;_&quot;)[,1], labels = 1:2)
batch &lt;- tibble(batch = batch, id = samps)
colnames(rawPE)[7:ncol(rawPE)] &lt;- samps
colnames(rawSE)[7:ncol(rawSE)] &lt;- samps

counts &lt;- rawPE[, 7:ncol(rawPE)] + rawSE[, 7:ncol(rawSE)] 
dge &lt;- DGEList(counts = counts,
                 genes = rawPE[,c(1,6)])
dge</code></pre>
<pre><code>An object of class &quot;DGEList&quot;
$counts
  CMV30 CMV31 CMV8 CMV9 CMV26 CMV27 CMV14 CMV15 CMV20 CMV21 CMV1 CMV2 CMV3 CMV4
1     0     0    0    0     2     2     0     1     0     1    1    0    1    0
2    58    95   58   59   113   101    60    48    79    71   54   63   39   46
3     1     0    0    0     0     0     0     0     0     0    0    0    0    0
4     0     0    0    0     0     0     0     0     0     0    1    0    1    0
5     0     0    0    0     0     0     0     0     0     0    0    0    0    0
  CMV10 CMV11 CMV18 CMV19 CMV35 Corriel NTC-2 CMV51 CMV52 CMV53 CMV54 CMV56
1     0     0     0     0     1       1     0     0     0     0     0     0
2    62    35    51    45    59      84     0    63    28    49    46    37
3     0     0     0     0     0       1     0     0     0     0     0     0
4     0     0     0     0     0       0     0     0     0     0     0     0
5     0     0     0     0     0       0     0     0     0     0     0     0
  CMV57 CMV58 CMV60 CMV61
1     0     2     1     2
2    59    82    44    36
3     0     0     0     0
4     0     0     1     0
5     0     0     0     0
60664 more rows ...

$samples
      group lib.size norm.factors
CMV30     1  4673630            1
CMV31     1  5232010            1
CMV8      1  3594801            1
CMV9      1  3425478            1
CMV26     1  4892776            1
25 more rows ...

$genes
             Geneid Length
1 ENSG00000223972.5   1735
2 ENSG00000227232.5   1351
3 ENSG00000278267.1     68
4 ENSG00000243485.5   1021
5 ENSG00000284332.1    138
60664 more rows ...</code></pre>
<p>Load sample information and file names.</p>
<pre class="r"><code>samps1 &lt;- read_csv(here(&quot;data/CMV-AF-database-corrected-oct-2020.csv&quot;))
samps2 &lt;- read_csv(here(&quot;data/samples.csv&quot;))

samps1 %&gt;% full_join(samps2, by = c(&quot;sequencing_ID&quot; = &quot;SampleId&quot;)) %&gt;%
  mutate(pair = ifelse(!is.na(matched_pair), matched_pair,
                        ifelse(!is.na(MatchedPair), MatchedPair, NA)),
         CMV_status = ifelse(!is.na(CMV_status), CMV_status,
                         ifelse(!is.na(TestResult), TestResult, NA)),
         Sex = toupper(Sex),
         Indication = tolower(Indication)) %&gt;%
  dplyr::rename(sex = Sex, 
         id = sequencing_ID, 
         indication = Indication,
         GA_at_amnio = `GA_at_amnio-completed_weeks`) -&gt; samps
       
read_csv(file = here(&quot;data/metadata.csv&quot;)) %&gt;%
  inner_join(read_csv(file = here(&quot;data/joindata.csv&quot;)), 
                      by = c(&quot;Record.ID&quot; = &quot;UR&quot;)) %&gt;%
  right_join(samps, by = c(&quot;ID post-extraction&quot; = &quot;id&quot;)) %&gt;%
  na_if(&quot;NA&quot;) %&gt;%
  mutate(sex = ifelse(!is.na(sex), sex,
                        ifelse(!is.na(Sex), toupper(Sex), NA)),
         GA_at_amnio = ifelse(!is.na(GA_at_amnio), GA_at_amnio,
                         ifelse(!is.na(GA.at.amnio), GA.at.amnio, NA))) %&gt;%
  dplyr::rename(id = `ID post-extraction`) %&gt;%
  dplyr::select(id, 
                CMV_status, 
                pair, 
                sex, 
                GA_at_amnio, 
                indication) %&gt;%
  left_join(batch) %&gt;%
  dplyr::filter(id %in% colnames(dge)) %&gt;%
  drop_na() -&gt; targets

m &lt;- match(colnames(dge), targets$id)
targets &lt;- targets[m[!is.na(m)], ]
  
targets</code></pre>
<pre><code># A tibble: 26 x 7
   id    CMV_status pair  sex   GA_at_amnio indication batch
   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;fct&gt;
 1 CMV30 pos        L1    F     21          no_us_ab   1    
 2 CMV31 neg        L1    F     21          no_us_ab   1    
 3 CMV8  neg        L2    F     23          no_us_ab   1    
 4 CMV9  pos        L2    F     23          no_us_ab   1    
 5 CMV26 pos        L3    F     22          no_us_ab   1    
 6 CMV14 neg        L4    F     21          no_us_ab   1    
 7 CMV15 pos        L4    F     22          no_us_ab   1    
 8 CMV20 pos        L5    M     21          no_us_ab   1    
 9 CMV21 neg        NC1   F     21          no_us_ab   1    
10 CMV1  pos        M1    F     21          no_us_ab   1    
# … with 16 more rows</code></pre>
</div>
<div id="quality-control" class="section level1">
<h1>Quality control</h1>
<p>Genes that do not have an adequate number of reads in any sample should be filtered out prior to downstream analyses. From a biological perspective, genes that are not expressed at a biologically meaningful level in any condition are not of interest. Statistically, we get a better estimate of the mean-variance relationship in the data and reduce the number of statistical tests that are performed during differential expression analyses.</p>
<p>Filter out lowly expressed genes and genes without Entrez IDs and calculate TMM normalization factors.</p>
<pre class="r"><code>z &lt;- dge[, colnames(dge) %in% targets$id] # retain only relevant samples
z$genes$Ensembl &lt;- strsplit2(z$genes$Geneid, &quot;.&quot;, fixed = TRUE)[,1]
z$group &lt;- targets$CMV_status

edb &lt;- EnsDb.Hsapiens.v86 # add Gene Symbols and Entrez IDs
z$genes &lt;- left_join(z$genes, ensembldb::genes(edb, 
                                        filter = GeneIdFilter(z$genes$Ensembl), 
                                        columns = c(&quot;gene_id&quot;, 
                                                    &quot;symbol&quot;, 
                                                    &quot;entrezid&quot;), 
                                        return.type = &quot;data.frame&quot;), 
                       by = c(&quot;Ensembl&quot; = &quot;gene_id&quot;))
z$genes$entrezid &lt;- unlist(sapply(z$genes$entrezid, function(x) {
  if(is.null(x)) NA else x[length(x)]
}), use.names = FALSE)

keep &lt;- !is.na(z$genes$entrezid) &amp; !is.null(z$genes$entrezid)
x &lt;- z[keep, ] # remove genes without Entrez IDs

keep &lt;- filterByExpr(x, group = z$group)
x &lt;- x[keep, ] # remove lowly expressed genes

y &lt;- calcNormFactors(x)
y</code></pre>
<pre><code>An object of class &quot;DGEList&quot;
$counts
   CMV30 CMV31 CMV8 CMV9 CMV26 CMV14 CMV15 CMV20 CMV21 CMV1 CMV2 CMV3 CMV4
32    20    36   28   42    28    25    19    26    18   32   25   55   31
52    88    73   55   43    55    75    53    64    55   61   68   36   62
55     6    15   17   15    15     9    14    13    12    7   10   16   12
63   148   172  148  126   175   179   176   141   179  155  194  121  123
64    14    15   14   11    20    14     9    13    14   13   13   19   10
   CMV10 CMV11 CMV19 CMV35 CMV51 CMV52 CMV53 CMV54 CMV56 CMV57 CMV58 CMV60
32    15    11    22    24    25    19    23    20    18    23    24     8
52    69    11    35    47    59    49    42    37    38    49    65    49
55     7     2    11     9    19     9     6    12     7     7     7     5
63   156    44   107   164   144    71    71   137   136   122   131    88
64     9     3     6     9    14     3     9    12     5     7    12     5
   CMV61
32    20
52    49
55     6
63   108
64     3
12727 more rows ...

$samples
      group lib.size norm.factors
CMV30     1  4673630     1.017563
CMV31     1  5232010     1.052277
CMV8      1  3594801     1.052059
CMV9      1  3425478     1.026378
CMV26     1  4892776     1.068518
21 more rows ...

$genes
               Geneid Length         Ensembl       symbol  entrezid
32 ENSG00000230021.10   5495 ENSG00000230021 RP5-857K21.4 101928626
52 ENSG00000228794.10  15682 ENSG00000228794    LINC01128    643837
55  ENSG00000230368.2   1971 ENSG00000230368       FAM41C    284593
63 ENSG00000188976.11   5540 ENSG00000188976        NOC2L     26155
64 ENSG00000187961.14   3402 ENSG00000187961       KLHL17    339451
12727 more rows ...

$group
[1] &quot;pos&quot; &quot;neg&quot; &quot;neg&quot; &quot;pos&quot; &quot;pos&quot;
21 more elements ...</code></pre>
<p>Plotting the distribution log-CPM values shows that a majority of genes within each sample are either not expressed or lowly-expressed with log-CPM values that are small or negative.</p>
<pre class="r"><code>L &lt;- mean(z$samples$lib.size) * 1e-6
M &lt;- median(z$samples$lib.size) * 1e-6

par(mfrow = c(1,2))
lcpmz &lt;- cpm(z, log = TRUE)
lcpm.cutoff &lt;- log2(10/M + 2/L)
nsamples &lt;- ncol(z)
col &lt;- scales::hue_pal()(nsamples)
plot(density(lcpmz[,1]), col = col[1], lwd = 1, ylim = c(0, 2), las = 2, 
     main = &quot;&quot;, xlab = &quot;&quot;)
title(main = &quot;Unfiltered data&quot;, xlab = &quot;Log-cpm&quot;)
abline(v = lcpm.cutoff, lty = 3)
for (i in 2:nsamples){
  den &lt;- density(lcpmz[,i])
  lines(den$x, den$y, col = col[i], lwd = 1)
}

lcpmy &lt;- cpm(y, log=TRUE)
plot(density(lcpmy[,1]), col = col[1], lwd = 1, ylim = c(0, 0.25), las = 2, 
     main = &quot;&quot;, xlab = &quot;&quot;)
title(main = &quot;Filtered data&quot;, xlab = &quot;Log-cpm&quot;)
abline(v = lcpm.cutoff, lty = 3)
for (i in 2:nsamples){
  den &lt;- density(lcpmy[,i])
  lines(den$x, den$y, col = col[i], lwd = 1)
}</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-1">
Past versions of unnamed-chunk-5-1.png
</button>
</p>
<div id="fig-unnamed-chunk-5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-5-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Although in excess of 30 million reads were obtained per sample, we can see that after mapping, duplicate removal and quantification of gene expression the median library size is just under than 4 million reads. This suggests that we are likely to only be capturing the most abundant cfRNAs.</p>
<p>It is assumed that all samples should have a similar range and distribution of expression values. The raw data looks fairly uniform between samples, although TMM normalization further improves this.</p>
<pre class="r"><code>dat &lt;- data.frame(lib = y$samples$lib.size,
                  status = y$group,
                  sample = colnames(y))
p1 &lt;- ggplot(dat, aes(x = sample, y = lib, fill = status)) +
  geom_bar(stat = &quot;identity&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = &quot;Sample&quot;, y = &quot;Library size&quot;,
       fill = &quot;CMV Status&quot;) +
  geom_hline(yintercept = median(dat$lib), linetype = &quot;dashed&quot;) +
  scale_x_discrete(limits = dat$sample)

dat &lt;- reshape2::melt(cpm(y, normalized.lib.sizes = FALSE, log = TRUE),
                      value.name = &quot;cpm&quot;)
dat$status &lt;- rep(y$group, each = nrow(y))
colnames(dat)[2] &lt;- &quot;sample&quot;
p2 &lt;- ggplot(dat, aes(x = sample, y = cpm, fill = status)) +
  geom_boxplot(show.legend = FALSE, outlier.size = 0.75) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 7)) +
  labs(x = &quot;Sample&quot;, y = &quot;Library size&quot;,
       fill = &quot;CMV Status&quot;) +
  geom_hline(yintercept = median(dat$lib), linetype = &quot;dashed&quot;)

dat &lt;- reshape2::melt(cpm(y, normalized.lib.sizes = TRUE, log = TRUE),
                      value.name = &quot;cpm&quot;)
dat$status &lt;- rep(y$group, each = nrow(y))
colnames(dat)[2] &lt;- &quot;sample&quot;
p3 &lt;- ggplot(dat, aes(x = sample, y = cpm, fill = status)) +
  geom_boxplot(show.legend = FALSE, outlier.size = 0.75) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 7)) +
  labs(x = &quot;Sample&quot;, y = &quot;Library size&quot;,
       fill = &quot;CMV Status&quot;) +
  geom_hline(yintercept = median(dat$lib), linetype = &quot;dashed&quot;)

p1 / (p2 + p3) + plot_layout(guides = &quot;collect&quot;)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-6-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Multi-dimensional scaling (MDS) plots show the largest sources of variation in the data. They are a good way of exploring the relationships between the samples and identifying structure in the data. The following series of MDS plots examines the first four principal components. The samples are coloured by various known features of the samples such as CMV Status and foetal sex. The MDS plots do not show the samples strongly clustering by any of the known features of the data, although there does seem to be some separation between the CMV positive and negative samples in the 1st and 2nd principal components. This indicates that there are possibly some differentially expressed genes between CMV positive and negative samples.</p>
<p>A weak batch effect is also evident in the 3rd principal component, when we examine the plots coloured by batch.</p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(1,3), c(2,3), c(3,4))
vars &lt;- c(&quot;CMV_status&quot;, &quot;pair&quot;, &quot;sex&quot;, &quot;GA_at_amnio&quot;, &quot;indication&quot;, &quot;batch&quot;)
patches &lt;- vector(&quot;list&quot;, length(vars))

for(i in 1:length(vars)){
  p &lt;- vector(&quot;list&quot;, length(dims))
  
  for(j in 1:length(dims)){
    mds &lt;- plotMDS(cpm(y, log = TRUE), top = 1000, gene.selection=&quot;common&quot;, 
                   plot = FALSE, dim.plot = dims[[j]])
    dat &lt;- tibble::tibble(x = mds$x, y = mds$y,
                          sample = targets$id,
                          variable = pull(targets, vars[i]))
    
    p[[j]] &lt;- ggplot(dat, aes(x = x, y = y, colour = variable)) +
      geom_text(aes(label = sample), size = 2.5) +
      labs(x = glue::glue(&quot;Principal component {dims[[j]][1]}&quot;), 
           y = glue::glue(&quot;Principal component {dims[[j]][2]}&quot;),
           colour = vars[i])
  }
  
  patches[[i]] &lt;- wrap_elements(wrap_plots(p, ncol = 2, guides = &quot;collect&quot;) +
    plot_annotation(title = glue::glue(&quot;Coloured by: {vars[i]}&quot;)) &amp;
    theme(legend.position = &quot;bottom&quot;))
  
}

wrap_plots(patches, ncol = 1)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-7-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ruvseq-analysis" class="section level1">
<h1>RUVSeq analysis</h1>
<p>Given that there is a lot ov variability between the samples and it is not clearly associated with any of the known features of the data, we will use and <code>RUVSeq</code> analysis to remove some of the unwanted variation from the data. We will estimate the unwanted variation using the expression of known house-keeping genes (HKG), as defined using the Human BodyMap 2.0 <a href="https://www.tau.ac.il/~elieis/HKG/">data</a>, in our dataset.</p>
<p>The heatmap below shows the expression of the HKG in our samples. Although the expression is fairly uniform, some variability is apparent between the samples.</p>
<pre class="r"><code>hkGenes &lt;- read.delim(here(&quot;data/HK_genes.txt&quot;), stringsAsFactors = FALSE, 
                      header = FALSE, col.names = c(&quot;SYMBOL&quot;,&quot;REFSEQ&quot;), 
                      strip.white = TRUE)

aheatmap(cpm(y[y$genes$symbol %in% hkGenes$SYMBOL,], log = TRUE),
         main = &quot;log2 CPM Expression of HKG&quot;, labRow = NA,  
         annCol = list(GA_at_amnio = targets$GA_at_amnio, 
                       CMV_result = targets$CMV_status, 
                       Pair = targets$pair,
                       Sex = targets$sex),
         annColors = list(scales::brewer_pal(palette = &quot;Dark2&quot;)(length(unique(targets$GA_at_amnio))),
                          scales::hue_pal()(length(unique(targets$CMV_status))),
                          scales::hue_pal()(length(unique(targets$pair))),
                          scales::brewer_pal(palette = &quot;Set1&quot;)(length(unique(targets$sex)))),
         scale = &quot;none&quot;)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-1">
Past versions of unnamed-chunk-8-1.png
</button>
</p>
<div id="fig-unnamed-chunk-8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-8-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The scree plot shows that most of the variation in the negative control genes is captured by the first principal component.</p>
<pre class="r"><code>PCs &lt;- prcomp(t(y$counts[which(y$genes$symbol %in% hkGenes$SYMBOL),]), 
              center = TRUE, scale = TRUE, retx=TRUE)
loadings = PCs$x # pc loadings
plot(PCs, type=&quot;lines&quot;) # scree plot</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-1">
Past versions of unnamed-chunk-9-1.png
</button>
</p>
<div id="fig-unnamed-chunk-9-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-9-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Using the <code>RUVg</code> function, we will estimate the unwanted variation in our data using the HKG for k = 1, 2 and 3.</p>
<pre class="r"><code>yRg1 &lt;- RUVg(y$counts, which(y$genes$symbol %in% hkGenes$SYMBOL), k=1)
yRg2 &lt;- RUVg(y$counts, which(y$genes$symbol %in% hkGenes$SYMBOL), k=2)
yRg3 &lt;- RUVg(y$counts, which(y$genes$symbol %in% hkGenes$SYMBOL), k=3)</code></pre>
<p>The RLE plots below show that <code>RUVg</code> adjustment is a significant improvement over the raw data with k=1. The improvements with k=2 and k=3 are relatively minor in comparison.</p>
<pre class="r"><code>par(mfrow=c(2,2))
plotRLE(y$counts, ylim=c(-0.5,0.5), las=2, main=&quot;Raw&quot;,
        cex.axis = 0.6)
plotRLE(yRg1$normalizedCounts, ylim=c(-0.5,0.5), las=2, main=&quot;RUVg k=1&quot;, 
        cex.axis = 0.6)
plotRLE(yRg2$normalizedCounts, ylim=c(-0.5,0.5), las=2, main=&quot;RUVg k=2&quot;, 
        cex.axis = 0.6)
plotRLE(yRg3$normalizedCounts, ylim=c(-0.5,0.5), las=2, main=&quot;RUVg k=3&quot;, 
        cex.axis = 0.6)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/77ba079a747c0de04c91e94e3129beb7d7c4ee4b/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-11-1.png" target="_blank">77ba079</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-09-25
</td>
</tr>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-11-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The MDS plots of the <code>RUVg</code> normalised counts show clearer separation between the CMV positive and CMV negative samples.</p>
<pre class="r"><code>mds &lt;- plotMDS(cpm(y$counts, log = TRUE), top = 1000, gene.selection=&quot;common&quot;, 
               plot = FALSE)
dat &lt;- tibble::tibble(x = mds$x, y = mds$y,
                      sample = targets$id,
                      status = targets$CMV_status)

p &lt;- ggplot(dat, aes(x = x, y = y, colour = status)) +
  geom_text(aes(label = sample), size = 2.5) +
  labs(x = &quot;Principal component 1&quot;, 
       y = &quot;Principal component 2&quot;,
       colour = &quot;CMV status&quot;) +
  ggtitle(&quot;Raw&quot;)

mds &lt;- plotMDS(cpm(yRg1$normalizedCounts, log = TRUE), top = 1000, 
               gene.selection=&quot;common&quot;, plot = FALSE)
dat1 &lt;- tibble::tibble(x = mds$x, y = mds$y,
                      sample = targets$id,
                      status = targets$CMV_status)

p1 &lt;- ggplot(dat1, aes(x = x, y = y, colour = status)) +
  geom_text(aes(label = sample), size = 2.5) +
  labs(x = &quot;Principal component 1&quot;, 
       y = &quot;Principal component 2&quot;,
       colour = &quot;CMV status&quot;) +
  ggtitle(&quot;RUVg k=1&quot;)

mds &lt;- plotMDS(cpm(yRg2$normalizedCounts, log = TRUE), top = 1000, 
               gene.selection=&quot;common&quot;, plot = FALSE)
dat2 &lt;- tibble::tibble(x = mds$x, y = mds$y,
                      sample = targets$id,
                      status = targets$CMV_status)

p2 &lt;- ggplot(dat2, aes(x = x, y = y, colour = status)) +
  geom_text(aes(label = sample), size = 2.5) +
  labs(x = &quot;Principal component 1&quot;, 
       y = &quot;Principal component 2&quot;,
       colour = &quot;CMV status&quot;) +
  ggtitle(&quot;RUVg k=2&quot;)

mds &lt;- plotMDS(cpm(yRg3$normalizedCounts, log = TRUE), top = 1000, 
               gene.selection=&quot;common&quot;, plot = FALSE)
dat3 &lt;- tibble::tibble(x = mds$x, y = mds$y,
                      sample = targets$id,
                      status = targets$CMV_status)

p3 &lt;- ggplot(dat3, aes(x = x, y = y, colour = status)) +
  geom_text(aes(label = sample), size = 2.5) +
  labs(x = &quot;Principal component 1&quot;, 
       y = &quot;Principal component 2&quot;,
       colour = &quot;CMV status&quot;) +
  ggtitle(&quot;RUVg k=3&quot;)

((p | p1) / (p2 | p3)) + 
  plot_layout(guides = &quot;collect&quot;) &amp; 
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-12-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="differential-expression-analysis" class="section level1">
<h1>Differential expression analysis</h1>
<p>We will look for differentially expressed genes, using the negative binomial GLM approach implemented in <code>edgeR</code>. This is done by considering a design matrix that includes both the covariates of interest (CMV result) and the factors of unwanted variation calculated by <code>RUVg</code>. The CMV positive samples were compared to the CMV negative (normal) samples. A summary of the numbers of differentially expressed genes is shown below, as well as the top 20 differentially expressed genes. The full results tables were exported as csv files.</p>
<pre class="r"><code>norm &lt;- yRg1
design &lt;- model.matrix(~targets$CMV_status + targets$pair + norm$W)
colnames(design)[2] &lt;- &quot;CMV_status&quot;
y &lt;- estimateGLMCommonDisp(y, design)
y &lt;- estimateGLMTagwiseDisp(y, design)
fit &lt;- glmFit(y, design)
lrt &lt;- glmLRT(fit, coef = 2)
fitSum &lt;- summary(decideTests(lrt, p.value = 0.05))
fitSum</code></pre>
<pre><code>       CMV_status
Down           32
NotSig      12391
Up            309</code></pre>
<p>There were 32 down-regulated and 309 up-regulated genes between CMV positive and CMV negative samples at FDR &lt; 0.05.</p>
<p>These are the top 10 differentially expressed genes.</p>
<pre class="r"><code>top &lt;- topTags(lrt, n = 500)$table
readr::write_csv(top, path = here(&quot;output/star-fc-ruv-all.csv&quot;))</code></pre>
<pre><code>Warning: The `path` argument of `write_csv()` is deprecated as of readr 1.4.0.
Please use the `file` argument instead.</code></pre>
<pre class="r"><code>head(top, n=10)</code></pre>
<pre><code>                  Geneid Length         Ensembl symbol entrezid    logFC
51897 ENSG00000130303.13   1101 ENSG00000130303   BST2      684 3.362931
19329 ENSG00000206337.12  11058 ENSG00000206337   HCP5    10866 4.774945
45751 ENSG00000140853.15  12386 ENSG00000140853  NLRC5    84166 2.719464
14201  ENSG00000138646.9   4764 ENSG00000138646  HERC5    51191 2.990825
2240   ENSG00000225492.6   2352 ENSG00000225492 GBP1P1   400759 1.921814
8687  ENSG00000115415.20   9770 ENSG00000115415  STAT1     6772 1.214164
15204 ENSG00000137628.17   6746 ENSG00000137628  DDX60    55601 1.601443
56048 ENSG00000157601.14   8616 ENSG00000157601    MX1     4599 1.662165
46903 ENSG00000132530.17   6615 ENSG00000132530   XAF1    54739 2.660971
2095  ENSG00000137965.11   2038 ENSG00000137965  IFI44    10561 1.949726
        logCPM        LR       PValue          FDR
51897 3.753005 127.21029 1.670963e-29 2.127470e-25
19329 3.767357  94.03723 3.096454e-22 1.971203e-18
45751 3.086826  79.24646 5.482552e-19 2.326795e-15
14201 3.088271  77.12931 1.601235e-18 5.096730e-15
2240  2.478891  64.45998 9.851325e-16 2.508541e-12
8687  8.158754  59.08642 1.508967e-14 3.202028e-11
15204 6.361836  58.45469 2.080272e-14 3.783718e-11
56048 7.264249  56.24278 6.405258e-14 9.498385e-11
46903 5.948849  56.15016 6.714221e-14 9.498385e-11
2095  5.029527  53.51359 2.568103e-13 3.269708e-10</code></pre>
<p>The following plots show the expression of the top 12 ranked differentially expressed genes for CMV positive and CMV negative samples. Although there is significant variability within the groups and the log2 fold changes are not large, there are obvious differences in expression for the top ranked genes.</p>
<pre class="r"><code>dat &lt;- reshape2::melt(cpm(norm$normalizedCounts, log = TRUE),
                      value.name = &quot;cpm&quot;)
dat$status &lt;- rep(y$group, each = nrow(y))
dat$gene &lt;- rep(y$genes$Geneid, ncol(y))

p &lt;- vector(&quot;list&quot;, 12)

for(i in 1:length(p)){
p[[i]] &lt;- ggplot(data = subset(dat, dat$gene == top$Geneid[i]), 
       aes(x = status, y = cpm, colour = status)) +
  geom_jitter(width = 0.25) +
  stat_summary(fun = &quot;mean&quot;, geom = &quot;crossbar&quot;) +
  labs(x = &quot;Status&quot;, y = &quot;log2 Norm. CPM&quot;, colour = &quot;Status&quot;) +
  ggtitle(top$symbol[i]) +
  theme(plot.title = element_text(size = 8),
        plot.subtitle = element_text(size = 7),
        axis.title = element_text(size = 8),
        axis.text.x = element_text(size = 7))
}

wrap_plots(p, guides = &quot;collect&quot;, ncol = 3) &amp; 
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/ccd6c80f45830e95d6c0241a7327a5d05b801661/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-15-1.png" target="_blank">ccd6c80</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-10-29
</td>
</tr>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/77ba079a747c0de04c91e94e3129beb7d7c4ee4b/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-15-1.png" target="_blank">77ba079</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-09-25
</td>
</tr>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-15-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>cut &lt;- 0.05
aheatmap(cpm(norm$normalizedCounts[y$genes$Geneid %in% 
                                     top$Geneid[top$FDR &lt; cut], ], 
             log = TRUE), 
         annCol = list(CMV_result = targets$CMV_status),
         labRow = NA,
         main = glue::glue(&quot;DEGs at FDR &lt; {cut}&quot;))</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-16-1">
Past versions of unnamed-chunk-16-1.png
</button>
</p>
<div id="fig-unnamed-chunk-16-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-16-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="gene-set-enrichment-analysis-gsea" class="section level1">
<h1>Gene set enrichment analysis (GSEA)</h1>
<p>Testing for enrichment of Gene Ontology (GO) categories among statistically significant differentially expressed genes.</p>
<pre class="r"><code>go &lt;- goana(top$entrezid[top$FDR &lt; 0.05], universe = y$genes$entrezid, 
            trend = y$genes$Length)
topGO(go, number = Inf) %&gt;%
  mutate(FDR = p.adjust(P.DE)) %&gt;%
  dplyr::filter(FDR &lt; 0.05) %&gt;%
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="7%" />
<col width="73%" />
<col width="2%" />
<col width="3%" />
<col width="2%" />
<col width="5%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Term</th>
<th align="left">Ont</th>
<th align="right">N</th>
<th align="right">DE</th>
<th align="right">P.DE</th>
<th align="right">FDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="GO:0043207" class="uri">GO:0043207</a></td>
<td align="left">response to external biotic stimulus</td>
<td align="left">BP</td>
<td align="right">849</td>
<td align="right">90</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0051707" class="uri">GO:0051707</a></td>
<td align="left">response to other organism</td>
<td align="left">BP</td>
<td align="right">849</td>
<td align="right">90</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0009607" class="uri">GO:0009607</a></td>
<td align="left">response to biotic stimulus</td>
<td align="left">BP</td>
<td align="right">876</td>
<td align="right">91</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0045087" class="uri">GO:0045087</a></td>
<td align="left">innate immune response</td>
<td align="left">BP</td>
<td align="right">516</td>
<td align="right">70</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0006955" class="uri">GO:0006955</a></td>
<td align="left">immune response</td>
<td align="left">BP</td>
<td align="right">1177</td>
<td align="right">105</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0098542" class="uri">GO:0098542</a></td>
<td align="left">defense response to other organism</td>
<td align="left">BP</td>
<td align="right">628</td>
<td align="right">74</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0006952" class="uri">GO:0006952</a></td>
<td align="left">defense response</td>
<td align="left">BP</td>
<td align="right">913</td>
<td align="right">88</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0034340" class="uri">GO:0034340</a></td>
<td align="left">response to type I interferon</td>
<td align="left">BP</td>
<td align="right">74</td>
<td align="right">29</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0071357" class="uri">GO:0071357</a></td>
<td align="left">cellular response to type I interferon</td>
<td align="left">BP</td>
<td align="right">70</td>
<td align="right">28</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0060337" class="uri">GO:0060337</a></td>
<td align="left">type I interferon signaling pathway</td>
<td align="left">BP</td>
<td align="right">70</td>
<td align="right">28</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002376" class="uri">GO:0002376</a></td>
<td align="left">immune system process</td>
<td align="left">BP</td>
<td align="right">1887</td>
<td align="right">127</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0051607" class="uri">GO:0051607</a></td>
<td align="left">defense response to virus</td>
<td align="left">BP</td>
<td align="right">178</td>
<td align="right">38</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0009615" class="uri">GO:0009615</a></td>
<td align="left">response to virus</td>
<td align="left">BP</td>
<td align="right">231</td>
<td align="right">41</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0044419" class="uri">GO:0044419</a></td>
<td align="left">interspecies interaction between organisms</td>
<td align="left">BP</td>
<td align="right">1439</td>
<td align="right">102</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0009605" class="uri">GO:0009605</a></td>
<td align="left">response to external stimulus</td>
<td align="left">BP</td>
<td align="right">1674</td>
<td align="right">111</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002252" class="uri">GO:0002252</a></td>
<td align="left">immune effector process</td>
<td align="left">BP</td>
<td align="right">776</td>
<td align="right">70</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0034097" class="uri">GO:0034097</a></td>
<td align="left">response to cytokine</td>
<td align="left">BP</td>
<td align="right">802</td>
<td align="right">70</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0019221" class="uri">GO:0019221</a></td>
<td align="left">cytokine-mediated signaling pathway</td>
<td align="left">BP</td>
<td align="right">505</td>
<td align="right">53</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0034341" class="uri">GO:0034341</a></td>
<td align="left">response to interferon-gamma</td>
<td align="left">BP</td>
<td align="right">121</td>
<td align="right">26</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0071345" class="uri">GO:0071345</a></td>
<td align="left">cellular response to cytokine stimulus</td>
<td align="left">BP</td>
<td align="right">740</td>
<td align="right">63</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0031224" class="uri">GO:0031224</a></td>
<td align="left">intrinsic component of membrane</td>
<td align="left">CC</td>
<td align="right">2637</td>
<td align="right">136</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0060333" class="uri">GO:0060333</a></td>
<td align="left">interferon-gamma-mediated signaling pathway</td>
<td align="left">BP</td>
<td align="right">61</td>
<td align="right">19</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0016021" class="uri">GO:0016021</a></td>
<td align="left">integral component of membrane</td>
<td align="left">CC</td>
<td align="right">2563</td>
<td align="right">130</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0071346" class="uri">GO:0071346</a></td>
<td align="left">cellular response to interferon-gamma</td>
<td align="left">BP</td>
<td align="right">109</td>
<td align="right">23</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0019883" class="uri">GO:0019883</a></td>
<td align="left">antigen processing and presentation of endogenous antigen</td>
<td align="left">BP</td>
<td align="right">15</td>
<td align="right">10</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0050776" class="uri">GO:0050776</a></td>
<td align="left">regulation of immune response</td>
<td align="left">BP</td>
<td align="right">513</td>
<td align="right">46</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0001817" class="uri">GO:0001817</a></td>
<td align="left">regulation of cytokine production</td>
<td align="left">BP</td>
<td align="right">440</td>
<td align="right">42</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0009986" class="uri">GO:0009986</a></td>
<td align="left">cell surface</td>
<td align="left">CC</td>
<td align="right">398</td>
<td align="right">39</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:1903900" class="uri">GO:1903900</a></td>
<td align="left">regulation of viral life cycle</td>
<td align="left">BP</td>
<td align="right">126</td>
<td align="right">22</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0007166" class="uri">GO:0007166</a></td>
<td align="left">cell surface receptor signaling pathway</td>
<td align="left">BP</td>
<td align="right">1939</td>
<td align="right">102</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0001816" class="uri">GO:0001816</a></td>
<td align="left">cytokine production</td>
<td align="left">BP</td>
<td align="right">483</td>
<td align="right">43</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002483" class="uri">GO:0002483</a></td>
<td align="left">antigen processing and presentation of endogenous peptide antigen</td>
<td align="left">BP</td>
<td align="right">13</td>
<td align="right">9</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0019885" class="uri">GO:0019885</a></td>
<td align="left">antigen processing and presentation of endogenous peptide antigen via MHC class I</td>
<td align="left">BP</td>
<td align="right">13</td>
<td align="right">9</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0009617" class="uri">GO:0009617</a></td>
<td align="left">response to bacterium</td>
<td align="left">BP</td>
<td align="right">335</td>
<td align="right">35</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0071310" class="uri">GO:0071310</a></td>
<td align="left">cellular response to organic substance</td>
<td align="left">BP</td>
<td align="right">1817</td>
<td align="right">97</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002682" class="uri">GO:0002682</a></td>
<td align="left">regulation of immune system process</td>
<td align="left">BP</td>
<td align="right">909</td>
<td align="right">62</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0031347" class="uri">GO:0031347</a></td>
<td align="left">regulation of defense response</td>
<td align="left">BP</td>
<td align="right">432</td>
<td align="right">40</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0005887" class="uri">GO:0005887</a></td>
<td align="left">integral component of plasma membrane</td>
<td align="left">CC</td>
<td align="right">667</td>
<td align="right">51</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000002</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0048525" class="uri">GO:0048525</a></td>
<td align="left">negative regulation of viral process</td>
<td align="left">BP</td>
<td align="right">77</td>
<td align="right">17</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000003</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0045071" class="uri">GO:0045071</a></td>
<td align="left">negative regulation of viral genome replication</td>
<td align="left">BP</td>
<td align="right">48</td>
<td align="right">14</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000003</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0070887" class="uri">GO:0070887</a></td>
<td align="left">cellular response to chemical stimulus</td>
<td align="left">BP</td>
<td align="right">2197</td>
<td align="right">109</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000004</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0031226" class="uri">GO:0031226</a></td>
<td align="left">intrinsic component of plasma membrane</td>
<td align="left">CC</td>
<td align="right">705</td>
<td align="right">52</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000005</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0005886" class="uri">GO:0005886</a></td>
<td align="left">plasma membrane</td>
<td align="left">CC</td>
<td align="right">2845</td>
<td align="right">130</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000005</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0032101" class="uri">GO:0032101</a></td>
<td align="left">regulation of response to external stimulus</td>
<td align="left">BP</td>
<td align="right">631</td>
<td align="right">48</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000011</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002831" class="uri">GO:0002831</a></td>
<td align="left">regulation of response to biotic stimulus</td>
<td align="left">BP</td>
<td align="right">277</td>
<td align="right">30</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000015</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:1903901" class="uri">GO:1903901</a></td>
<td align="left">negative regulation of viral life cycle</td>
<td align="left">BP</td>
<td align="right">63</td>
<td align="right">15</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000016</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0045069" class="uri">GO:0045069</a></td>
<td align="left">regulation of viral genome replication</td>
<td align="left">BP</td>
<td align="right">85</td>
<td align="right">17</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000017</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0071944" class="uri">GO:0071944</a></td>
<td align="left">cell periphery</td>
<td align="left">CC</td>
<td align="right">2926</td>
<td align="right">131</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000017</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002250" class="uri">GO:0002250</a></td>
<td align="left">adaptive immune response</td>
<td align="left">BP</td>
<td align="right">195</td>
<td align="right">25</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000017</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002697" class="uri">GO:0002697</a></td>
<td align="left">regulation of immune effector process</td>
<td align="left">BP</td>
<td align="right">231</td>
<td align="right">27</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000025</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0010033" class="uri">GO:0010033</a></td>
<td align="left">response to organic substance</td>
<td align="left">BP</td>
<td align="right">2227</td>
<td align="right">107</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000042</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0043903" class="uri">GO:0043903</a></td>
<td align="left">regulation of symbiotic process</td>
<td align="left">BP</td>
<td align="right">190</td>
<td align="right">24</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000056</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0050792" class="uri">GO:0050792</a></td>
<td align="left">regulation of viral process</td>
<td align="left">BP</td>
<td align="right">178</td>
<td align="right">23</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000084</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0045177" class="uri">GO:0045177</a></td>
<td align="left">apical part of cell</td>
<td align="left">CC</td>
<td align="right">299</td>
<td align="right">30</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000100</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0019079" class="uri">GO:0019079</a></td>
<td align="left">viral genome replication</td>
<td align="left">BP</td>
<td align="right">109</td>
<td align="right">18</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000127</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0050777" class="uri">GO:0050777</a></td>
<td align="left">negative regulation of immune response</td>
<td align="left">BP</td>
<td align="right">87</td>
<td align="right">16</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000225</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0042221" class="uri">GO:0042221</a></td>
<td align="left">response to chemical</td>
<td align="left">BP</td>
<td align="right">2816</td>
<td align="right">124</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000235</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0006950" class="uri">GO:0006950</a></td>
<td align="left">response to stress</td>
<td align="left">BP</td>
<td align="right">2756</td>
<td align="right">122</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000250</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0050896" class="uri">GO:0050896</a></td>
<td align="left">response to stimulus</td>
<td align="left">BP</td>
<td align="right">5571</td>
<td align="right">204</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000321</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0045088" class="uri">GO:0045088</a></td>
<td align="left">regulation of innate immune response</td>
<td align="left">BP</td>
<td align="right">208</td>
<td align="right">24</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000362</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0005215" class="uri">GO:0005215</a></td>
<td align="left">transporter activity</td>
<td align="left">MF</td>
<td align="right">633</td>
<td align="right">45</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000404</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0016324" class="uri">GO:0016324</a></td>
<td align="left">apical plasma membrane</td>
<td align="left">CC</td>
<td align="right">245</td>
<td align="right">26</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000459</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0005576" class="uri">GO:0005576</a></td>
<td align="left">extracellular region</td>
<td align="left">CC</td>
<td align="right">2416</td>
<td align="right">110</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000531</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0044403" class="uri">GO:0044403</a></td>
<td align="left">symbiotic process</td>
<td align="left">BP</td>
<td align="right">828</td>
<td align="right">53</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000531</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0005903" class="uri">GO:0005903</a></td>
<td align="left">brush border</td>
<td align="left">CC</td>
<td align="right">82</td>
<td align="right">15</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000813</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0048584" class="uri">GO:0048584</a></td>
<td align="left">positive regulation of response to stimulus</td>
<td align="left">BP</td>
<td align="right">1500</td>
<td align="right">78</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000935</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0042277" class="uri">GO:0042277</a></td>
<td align="left">peptide binding</td>
<td align="left">MF</td>
<td align="right">172</td>
<td align="right">21</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001397</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002449" class="uri">GO:0002449</a></td>
<td align="left">lymphocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">126</td>
<td align="right">18</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001406</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0045824" class="uri">GO:0045824</a></td>
<td align="left">negative regulation of innate immune response</td>
<td align="left">BP</td>
<td align="right">41</td>
<td align="right">11</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001420</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0015711" class="uri">GO:0015711</a></td>
<td align="left">organic anion transport</td>
<td align="left">BP</td>
<td align="right">296</td>
<td align="right">28</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001457</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002718" class="uri">GO:0002718</a></td>
<td align="left">regulation of cytokine production involved in immune response</td>
<td align="left">BP</td>
<td align="right">51</td>
<td align="right">12</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001489</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0019058" class="uri">GO:0019058</a></td>
<td align="left">viral life cycle</td>
<td align="left">BP</td>
<td align="right">279</td>
<td align="right">27</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001679</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0006820" class="uri">GO:0006820</a></td>
<td align="left">anion transport</td>
<td align="left">BP</td>
<td align="right">379</td>
<td align="right">32</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001928</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0050778" class="uri">GO:0050778</a></td>
<td align="left">positive regulation of immune response</td>
<td align="left">BP</td>
<td align="right">379</td>
<td align="right">32</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001928</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0007154" class="uri">GO:0007154</a></td>
<td align="left">cell communication</td>
<td align="left">BP</td>
<td align="right">3936</td>
<td align="right">155</td>
<td align="right">0.0e+00</td>
<td align="right">0.0002082</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002703" class="uri">GO:0002703</a></td>
<td align="left">regulation of leukocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">115</td>
<td align="right">17</td>
<td align="right">0.0e+00</td>
<td align="right">0.0002191</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0023052" class="uri">GO:0023052</a></td>
<td align="left">signaling</td>
<td align="left">BP</td>
<td align="right">3907</td>
<td align="right">154</td>
<td align="right">0.0e+00</td>
<td align="right">0.0002288</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002684" class="uri">GO:0002684</a></td>
<td align="left">positive regulation of immune system process</td>
<td align="left">BP</td>
<td align="right">579</td>
<td align="right">41</td>
<td align="right">0.0e+00</td>
<td align="right">0.0002543</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0016032" class="uri">GO:0016032</a></td>
<td align="left">viral process</td>
<td align="left">BP</td>
<td align="right">793</td>
<td align="right">49</td>
<td align="right">0.0e+00</td>
<td align="right">0.0007116</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0098590" class="uri">GO:0098590</a></td>
<td align="left">plasma membrane region</td>
<td align="left">CC</td>
<td align="right">749</td>
<td align="right">47</td>
<td align="right">0.0e+00</td>
<td align="right">0.0008811</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0006811" class="uri">GO:0006811</a></td>
<td align="left">ion transport</td>
<td align="left">BP</td>
<td align="right">907</td>
<td align="right">53</td>
<td align="right">1.0e-07</td>
<td align="right">0.0011703</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0050892" class="uri">GO:0050892</a></td>
<td align="left">intestinal absorption</td>
<td align="left">BP</td>
<td align="right">30</td>
<td align="right">9</td>
<td align="right">1.0e-07</td>
<td align="right">0.0011757</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0007165" class="uri">GO:0007165</a></td>
<td align="left">signal transduction</td>
<td align="left">BP</td>
<td align="right">3630</td>
<td align="right">143</td>
<td align="right">1.0e-07</td>
<td align="right">0.0013451</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0005615" class="uri">GO:0005615</a></td>
<td align="left">extracellular space</td>
<td align="left">CC</td>
<td align="right">2005</td>
<td align="right">92</td>
<td align="right">1.0e-07</td>
<td align="right">0.0013482</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0042611" class="uri">GO:0042611</a></td>
<td align="left">MHC protein complex</td>
<td align="left">CC</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">1.0e-07</td>
<td align="right">0.0014211</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0045953" class="uri">GO:0045953</a></td>
<td align="left">negative regulation of natural killer cell mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">1.0e-07</td>
<td align="right">0.0014211</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002716" class="uri">GO:0002716</a></td>
<td align="left">negative regulation of natural killer cell mediated immunity</td>
<td align="left">BP</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">1.0e-07</td>
<td align="right">0.0014211</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002480" class="uri">GO:0002480</a></td>
<td align="left">antigen processing and presentation of exogenous peptide antigen via MHC class I, TAP-independent</td>
<td align="left">BP</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">1.0e-07</td>
<td align="right">0.0016425</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0042612" class="uri">GO:0042612</a></td>
<td align="left">MHC class I protein complex</td>
<td align="left">CC</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">1.0e-07</td>
<td align="right">0.0016425</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0001910" class="uri">GO:0001910</a></td>
<td align="left">regulation of leukocyte mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">32</td>
<td align="right">9</td>
<td align="right">1.0e-07</td>
<td align="right">0.0021971</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002367" class="uri">GO:0002367</a></td>
<td align="left">cytokine production involved in immune response</td>
<td align="left">BP</td>
<td align="right">64</td>
<td align="right">12</td>
<td align="right">1.0e-07</td>
<td align="right">0.0022479</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0016020" class="uri">GO:0016020</a></td>
<td align="left">membrane</td>
<td align="left">CC</td>
<td align="right">5677</td>
<td align="right">200</td>
<td align="right">1.0e-07</td>
<td align="right">0.0024415</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0001911" class="uri">GO:0001911</a></td>
<td align="left">negative regulation of leukocyte mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">11</td>
<td align="right">6</td>
<td align="right">1.0e-07</td>
<td align="right">0.0030547</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0007586" class="uri">GO:0007586</a></td>
<td align="left">digestion</td>
<td align="left">BP</td>
<td align="right">67</td>
<td align="right">12</td>
<td align="right">2.0e-07</td>
<td align="right">0.0038173</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002819" class="uri">GO:0002819</a></td>
<td align="left">regulation of adaptive immune response</td>
<td align="left">BP</td>
<td align="right">94</td>
<td align="right">14</td>
<td align="right">2.0e-07</td>
<td align="right">0.0040242</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0033218" class="uri">GO:0033218</a></td>
<td align="left">amide binding</td>
<td align="left">MF</td>
<td align="right">227</td>
<td align="right">22</td>
<td align="right">2.0e-07</td>
<td align="right">0.0041156</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002699" class="uri">GO:0002699</a></td>
<td align="left">positive regulation of immune effector process</td>
<td align="left">BP</td>
<td align="right">124</td>
<td align="right">16</td>
<td align="right">2.0e-07</td>
<td align="right">0.0041782</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0042269" class="uri">GO:0042269</a></td>
<td align="left">regulation of natural killer cell mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">18</td>
<td align="right">7</td>
<td align="right">2.0e-07</td>
<td align="right">0.0048222</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002715" class="uri">GO:0002715</a></td>
<td align="left">regulation of natural killer cell mediated immunity</td>
<td align="left">BP</td>
<td align="right">18</td>
<td align="right">7</td>
<td align="right">2.0e-07</td>
<td align="right">0.0048222</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0010876" class="uri">GO:0010876</a></td>
<td align="left">lipid localization</td>
<td align="left">BP</td>
<td align="right">268</td>
<td align="right">24</td>
<td align="right">2.0e-07</td>
<td align="right">0.0050195</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002683" class="uri">GO:0002683</a></td>
<td align="left">negative regulation of immune system process</td>
<td align="left">BP</td>
<td align="right">268</td>
<td align="right">24</td>
<td align="right">2.0e-07</td>
<td align="right">0.0050195</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0046977" class="uri">GO:0046977</a></td>
<td align="left">TAP binding</td>
<td align="left">MF</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">3.0e-07</td>
<td align="right">0.0056182</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0051239" class="uri">GO:0051239</a></td>
<td align="left">regulation of multicellular organismal process</td>
<td align="left">BP</td>
<td align="right">2067</td>
<td align="right">92</td>
<td align="right">3.0e-07</td>
<td align="right">0.0056626</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0051241" class="uri">GO:0051241</a></td>
<td align="left">negative regulation of multicellular organismal process</td>
<td align="left">BP</td>
<td align="right">772</td>
<td align="right">46</td>
<td align="right">3.0e-07</td>
<td align="right">0.0056764</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0062023" class="uri">GO:0062023</a></td>
<td align="left">collagen-containing extracellular matrix</td>
<td align="left">CC</td>
<td align="right">213</td>
<td align="right">21</td>
<td align="right">3.0e-07</td>
<td align="right">0.0058728</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0001818" class="uri">GO:0001818</a></td>
<td align="left">negative regulation of cytokine production</td>
<td align="left">BP</td>
<td align="right">160</td>
<td align="right">18</td>
<td align="right">3.0e-07</td>
<td align="right">0.0059737</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002720" class="uri">GO:0002720</a></td>
<td align="left">positive regulation of cytokine production involved in immune response</td>
<td align="left">BP</td>
<td align="right">36</td>
<td align="right">9</td>
<td align="right">3.0e-07</td>
<td align="right">0.0067008</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0098862" class="uri">GO:0098862</a></td>
<td align="left">cluster of actin-based cell projections</td>
<td align="left">CC</td>
<td align="right">113</td>
<td align="right">15</td>
<td align="right">3.0e-07</td>
<td align="right">0.0069255</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002700" class="uri">GO:0002700</a></td>
<td align="left">regulation of production of molecular mediator of immune response</td>
<td align="left">BP</td>
<td align="right">84</td>
<td align="right">13</td>
<td align="right">3.0e-07</td>
<td align="right">0.0069781</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002704" class="uri">GO:0002704</a></td>
<td align="left">negative regulation of leukocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">27</td>
<td align="right">8</td>
<td align="right">4.0e-07</td>
<td align="right">0.0073091</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0006869" class="uri">GO:0006869</a></td>
<td align="left">lipid transport</td>
<td align="left">BP</td>
<td align="right">236</td>
<td align="right">22</td>
<td align="right">4.0e-07</td>
<td align="right">0.0080903</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0051716" class="uri">GO:0051716</a></td>
<td align="left">cellular response to stimulus</td>
<td align="left">BP</td>
<td align="right">4707</td>
<td align="right">171</td>
<td align="right">4.0e-07</td>
<td align="right">0.0087994</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0048878" class="uri">GO:0048878</a></td>
<td align="left">chemical homeostasis</td>
<td align="left">BP</td>
<td align="right">710</td>
<td align="right">43</td>
<td align="right">5.0e-07</td>
<td align="right">0.0093559</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0022600" class="uri">GO:0022600</a></td>
<td align="left">digestive system process</td>
<td align="left">BP</td>
<td align="right">60</td>
<td align="right">11</td>
<td align="right">5.0e-07</td>
<td align="right">0.0097323</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0042267" class="uri">GO:0042267</a></td>
<td align="left">natural killer cell mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">28</td>
<td align="right">8</td>
<td align="right">5.0e-07</td>
<td align="right">0.0099925</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002228" class="uri">GO:0002228</a></td>
<td align="left">natural killer cell mediated immunity</td>
<td align="left">BP</td>
<td align="right">28</td>
<td align="right">8</td>
<td align="right">5.0e-07</td>
<td align="right">0.0099925</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002484" class="uri">GO:0002484</a></td>
<td align="left">antigen processing and presentation of endogenous peptide antigen via MHC class I via ER pathway</td>
<td align="left">BP</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">5.0e-07</td>
<td align="right">0.0105230</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002486" class="uri">GO:0002486</a></td>
<td align="left">antigen processing and presentation of endogenous peptide antigen via MHC class I via ER pathway, TAP-independent</td>
<td align="left">BP</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">5.0e-07</td>
<td align="right">0.0105230</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0031342" class="uri">GO:0031342</a></td>
<td align="left">negative regulation of cell killing</td>
<td align="left">BP</td>
<td align="right">13</td>
<td align="right">6</td>
<td align="right">5.0e-07</td>
<td align="right">0.0108254</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0001909" class="uri">GO:0001909</a></td>
<td align="left">leukocyte mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">49</td>
<td align="right">10</td>
<td align="right">6.0e-07</td>
<td align="right">0.0114300</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0001906" class="uri">GO:0001906</a></td>
<td align="left">cell killing</td>
<td align="left">BP</td>
<td align="right">74</td>
<td align="right">12</td>
<td align="right">6.0e-07</td>
<td align="right">0.0117828</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0060089" class="uri">GO:0060089</a></td>
<td align="left">molecular transducer activity</td>
<td align="left">MF</td>
<td align="right">367</td>
<td align="right">28</td>
<td align="right">7.0e-07</td>
<td align="right">0.0137105</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0038023" class="uri">GO:0038023</a></td>
<td align="left">signaling receptor activity</td>
<td align="left">MF</td>
<td align="right">367</td>
<td align="right">28</td>
<td align="right">7.0e-07</td>
<td align="right">0.0137105</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0031012" class="uri">GO:0031012</a></td>
<td align="left">extracellular matrix</td>
<td align="left">CC</td>
<td align="right">264</td>
<td align="right">23</td>
<td align="right">7.0e-07</td>
<td align="right">0.0146047</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0032103" class="uri">GO:0032103</a></td>
<td align="left">positive regulation of response to external stimulus</td>
<td align="left">BP</td>
<td align="right">306</td>
<td align="right">25</td>
<td align="right">8.0e-07</td>
<td align="right">0.0158929</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0001819" class="uri">GO:0001819</a></td>
<td align="left">positive regulation of cytokine production</td>
<td align="left">BP</td>
<td align="right">266</td>
<td align="right">23</td>
<td align="right">8.0e-07</td>
<td align="right">0.0166688</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0022857" class="uri">GO:0022857</a></td>
<td align="left">transmembrane transporter activity</td>
<td align="left">MF</td>
<td align="right">531</td>
<td align="right">35</td>
<td align="right">9.0e-07</td>
<td align="right">0.0176491</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0031526" class="uri">GO:0031526</a></td>
<td align="left">brush border membrane</td>
<td align="left">CC</td>
<td align="right">40</td>
<td align="right">9</td>
<td align="right">9.0e-07</td>
<td align="right">0.0176828</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002706" class="uri">GO:0002706</a></td>
<td align="left">regulation of lymphocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">77</td>
<td align="right">12</td>
<td align="right">9.0e-07</td>
<td align="right">0.0183485</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0001914" class="uri">GO:0001914</a></td>
<td align="left">regulation of T cell mediated cytotoxicity</td>
<td align="left">BP</td>
<td align="right">14</td>
<td align="right">6</td>
<td align="right">9.0e-07</td>
<td align="right">0.0185069</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002443" class="uri">GO:0002443</a></td>
<td align="left">leukocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">509</td>
<td align="right">34</td>
<td align="right">9.0e-07</td>
<td align="right">0.0188993</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0032609" class="uri">GO:0032609</a></td>
<td align="left">interferon-gamma production</td>
<td align="left">BP</td>
<td align="right">52</td>
<td align="right">10</td>
<td align="right">1.0e-06</td>
<td align="right">0.0204709</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0046903" class="uri">GO:0046903</a></td>
<td align="left">secretion</td>
<td align="left">BP</td>
<td align="right">995</td>
<td align="right">53</td>
<td align="right">1.1e-06</td>
<td align="right">0.0219462</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002707" class="uri">GO:0002707</a></td>
<td align="left">negative regulation of lymphocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">22</td>
<td align="right">7</td>
<td align="right">1.1e-06</td>
<td align="right">0.0235087</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0035456" class="uri">GO:0035456</a></td>
<td align="left">response to interferon-beta</td>
<td align="left">BP</td>
<td align="right">22</td>
<td align="right">7</td>
<td align="right">1.1e-06</td>
<td align="right">0.0235087</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0031341" class="uri">GO:0031341</a></td>
<td align="left">regulation of cell killing</td>
<td align="left">BP</td>
<td align="right">42</td>
<td align="right">9</td>
<td align="right">1.3e-06</td>
<td align="right">0.0274892</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002456" class="uri">GO:0002456</a></td>
<td align="left">T cell mediated immunity</td>
<td align="left">BP</td>
<td align="right">54</td>
<td align="right">10</td>
<td align="right">1.4e-06</td>
<td align="right">0.0295155</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0034378" class="uri">GO:0034378</a></td>
<td align="left">chylomicron assembly</td>
<td align="left">BP</td>
<td align="right">9</td>
<td align="right">5</td>
<td align="right">1.6e-06</td>
<td align="right">0.0321833</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002526" class="uri">GO:0002526</a></td>
<td align="left">acute inflammatory response</td>
<td align="left">BP</td>
<td align="right">43</td>
<td align="right">9</td>
<td align="right">1.7e-06</td>
<td align="right">0.0339467</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002832" class="uri">GO:0002832</a></td>
<td align="left">negative regulation of response to biotic stimulus</td>
<td align="left">BP</td>
<td align="right">68</td>
<td align="right">11</td>
<td align="right">1.7e-06</td>
<td align="right">0.0358858</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002221" class="uri">GO:0002221</a></td>
<td align="left">pattern recognition receptor signaling pathway</td>
<td align="left">BP</td>
<td align="right">146</td>
<td align="right">16</td>
<td align="right">1.9e-06</td>
<td align="right">0.0389923</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002474" class="uri">GO:0002474</a></td>
<td align="left">antigen processing and presentation of peptide antigen via MHC class I</td>
<td align="left">BP</td>
<td align="right">83</td>
<td align="right">12</td>
<td align="right">2.0e-06</td>
<td align="right">0.0418210</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0006953" class="uri">GO:0006953</a></td>
<td align="left">acute-phase response</td>
<td align="left">BP</td>
<td align="right">16</td>
<td align="right">6</td>
<td align="right">2.3e-06</td>
<td align="right">0.0471206</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0043202" class="uri">GO:0043202</a></td>
<td align="left">lysosomal lumen</td>
<td align="left">CC</td>
<td align="right">70</td>
<td align="right">11</td>
<td align="right">2.4e-06</td>
<td align="right">0.0482696</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0042632" class="uri">GO:0042632</a></td>
<td align="left">cholesterol homeostasis</td>
<td align="left">BP</td>
<td align="right">57</td>
<td align="right">10</td>
<td align="right">2.4e-06</td>
<td align="right">0.0495631</td>
</tr>
</tbody>
</table>
<p>GSEA helps us to interpret the results of a differential expression analysis. The <code>camera</code> function performs a competitive test to assess whether the genes in a given set are highly ranked in terms of differential expression relative to genes that are not in the set. We have tested several collections of gene sets from the Broad Institute’s Molecular Signatures Database <a href="http://software.broadinstitute.org/gsea/msigdb/index.jsp">MSigDB</a>.</p>
<p>Build gene set indexes.</p>
<pre class="r"><code>gsAnnots &lt;- buildIdx(entrezIDs = y$genes$entrezid, species = &quot;human&quot;,
                     msigdb.gsets = c(&quot;h&quot;, &quot;c2&quot;, &quot;c5&quot;))</code></pre>
<pre><code>[1] &quot;Loading MSigDB Gene Sets ... &quot;
[1] &quot;Loaded gene sets for the collection h ...&quot;
[1] &quot;Indexed the collection h ...&quot;
[1] &quot;Created annotation for the collection h ...&quot;
[1] &quot;Loaded gene sets for the collection c2 ...&quot;
[1] &quot;Indexed the collection c2 ...&quot;
[1] &quot;Created annotation for the collection c2 ...&quot;
[1] &quot;Loaded gene sets for the collection c5 ...&quot;
[1] &quot;Indexed the collection c5 ...&quot;
[1] &quot;Created annotation for the collection c5 ...&quot;
[1] &quot;Building KEGG pathways annotation object ... &quot;</code></pre>
<p>The GO gene sets consist of genes annotated by the same GO terms.</p>
<pre class="r"><code>c5Cam &lt;- camera(cpm(norm$normalizedCounts, log = TRUE), 
                gsAnnots$c5@idx, design, contrast = 2, trend.var = TRUE)
write.csv(c5Cam[c5Cam$FDR &lt; 0.05,], 
          file = here(&quot;output/star-fc-ruv-all-gsea-c5.csv&quot;))
head(c5Cam, n = 20)</code></pre>
<pre><code>                                                                     NGenes
GO_RESPONSE_TO_TYPE_I_INTERFERON                                         48
GO_DEFENSE_RESPONSE_TO_VIRUS                                            111
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_ANTIGEN             13
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_PEPTIDE_ANTIGEN     11
GO_INTERFERON_GAMMA_MEDIATED_SIGNALING_PATHWAY                           43
GO_RESPONSE_TO_INTERFERON_GAMMA                                          71
GO_CELLULAR_RESPONSE_TO_INTERFERON_GAMMA                                 59
GO_REGULATION_OF_CELL_KILLING                                            32
GO_LUMENAL_SIDE_OF_MEMBRANE                                              21
GO_RESPONSE_TO_VIRUS                                                    166
GO_DIGESTION                                                             56
GO_SOLUTE_PROTON_SYMPORTER_ACTIVITY                                      18
GO_INTRINSIC_COMPONENT_OF_ENDOPLASMIC_RETICULUM_MEMBRANE                108
GO_REGULATION_OF_LEUKOCYTE_MEDIATED_CYTOTOXICITY                         29
GO_CYTOKINE_MEDIATED_SIGNALING_PATHWAY                                  245
GO_POSITIVE_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY                    8
GO_MHC_PROTEIN_COMPLEX                                                   11
GO_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY                            12
GO_MHC_CLASS_I_PROTEIN_COMPLEX                                            7
GO_NEGATIVE_REGULATION_OF_VIRAL_GENOME_REPLICATION                       40
                                                                     Direction
GO_RESPONSE_TO_TYPE_I_INTERFERON                                            Up
GO_DEFENSE_RESPONSE_TO_VIRUS                                                Up
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_ANTIGEN                Up
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_PEPTIDE_ANTIGEN        Up
GO_INTERFERON_GAMMA_MEDIATED_SIGNALING_PATHWAY                              Up
GO_RESPONSE_TO_INTERFERON_GAMMA                                             Up
GO_CELLULAR_RESPONSE_TO_INTERFERON_GAMMA                                    Up
GO_REGULATION_OF_CELL_KILLING                                               Up
GO_LUMENAL_SIDE_OF_MEMBRANE                                                 Up
GO_RESPONSE_TO_VIRUS                                                        Up
GO_DIGESTION                                                                Up
GO_SOLUTE_PROTON_SYMPORTER_ACTIVITY                                         Up
GO_INTRINSIC_COMPONENT_OF_ENDOPLASMIC_RETICULUM_MEMBRANE                    Up
GO_REGULATION_OF_LEUKOCYTE_MEDIATED_CYTOTOXICITY                            Up
GO_CYTOKINE_MEDIATED_SIGNALING_PATHWAY                                      Up
GO_POSITIVE_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY                      Up
GO_MHC_PROTEIN_COMPLEX                                                      Up
GO_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY                               Up
GO_MHC_CLASS_I_PROTEIN_COMPLEX                                              Up
GO_NEGATIVE_REGULATION_OF_VIRAL_GENOME_REPLICATION                          Up
                                                                           PValue
GO_RESPONSE_TO_TYPE_I_INTERFERON                                     5.460966e-25
GO_DEFENSE_RESPONSE_TO_VIRUS                                         2.434725e-13
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_ANTIGEN         2.746440e-13
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_PEPTIDE_ANTIGEN 6.883739e-13
GO_INTERFERON_GAMMA_MEDIATED_SIGNALING_PATHWAY                       1.811001e-12
GO_RESPONSE_TO_INTERFERON_GAMMA                                      1.074724e-10
GO_CELLULAR_RESPONSE_TO_INTERFERON_GAMMA                             1.666906e-09
GO_REGULATION_OF_CELL_KILLING                                        2.399265e-08
GO_LUMENAL_SIDE_OF_MEMBRANE                                          2.459483e-08
GO_RESPONSE_TO_VIRUS                                                 4.041720e-08
GO_DIGESTION                                                         4.496659e-08
GO_SOLUTE_PROTON_SYMPORTER_ACTIVITY                                  4.719346e-08
GO_INTRINSIC_COMPONENT_OF_ENDOPLASMIC_RETICULUM_MEMBRANE             6.625694e-08
GO_REGULATION_OF_LEUKOCYTE_MEDIATED_CYTOTOXICITY                     9.594453e-08
GO_CYTOKINE_MEDIATED_SIGNALING_PATHWAY                               1.196610e-07
GO_POSITIVE_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY               1.447534e-07
GO_MHC_PROTEIN_COMPLEX                                               1.668634e-07
GO_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY                        1.986332e-07
GO_MHC_CLASS_I_PROTEIN_COMPLEX                                       2.335797e-07
GO_NEGATIVE_REGULATION_OF_VIRAL_GENOME_REPLICATION                   2.829899e-07
                                                                              FDR
GO_RESPONSE_TO_TYPE_I_INTERFERON                                     3.364501e-21
GO_DEFENSE_RESPONSE_TO_VIRUS                                         5.640272e-10
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_ANTIGEN         5.640272e-10
GO_ANTIGEN_PROCESSING_AND_PRESENTATION_OF_ENDOGENOUS_PEPTIDE_ANTIGEN 1.060268e-09
GO_INTERFERON_GAMMA_MEDIATED_SIGNALING_PATHWAY                       2.231515e-09
GO_RESPONSE_TO_INTERFERON_GAMMA                                      1.103563e-07
GO_CELLULAR_RESPONSE_TO_INTERFERON_GAMMA                             1.467115e-06
GO_REGULATION_OF_CELL_KILLING                                        1.683653e-05
GO_LUMENAL_SIDE_OF_MEMBRANE                                          1.683653e-05
GO_RESPONSE_TO_VIRUS                                                 2.422991e-05
GO_DIGESTION                                                         2.422991e-05
GO_SOLUTE_PROTON_SYMPORTER_ACTIVITY                                  2.422991e-05
GO_INTRINSIC_COMPONENT_OF_ENDOPLASMIC_RETICULUM_MEMBRANE             3.140069e-05
GO_REGULATION_OF_LEUKOCYTE_MEDIATED_CYTOTOXICITY                     4.222245e-05
GO_CYTOKINE_MEDIATED_SIGNALING_PATHWAY                               4.914876e-05
GO_POSITIVE_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY               5.573912e-05
GO_MHC_PROTEIN_COMPLEX                                               6.047327e-05
GO_REGULATION_OF_T_CELL_MEDIATED_CYTOTOXICITY                        6.798773e-05
GO_MHC_CLASS_I_PROTEIN_COMPLEX                                       7.574131e-05
GO_NEGATIVE_REGULATION_OF_VIRAL_GENOME_REPLICATION                   8.376287e-05</code></pre>
<p>The Hallmark gene sets are coherently expressed signatures derived by aggregating many MSigDB gene sets to represent well-defined biological states or processes.</p>
<pre class="r"><code>hCam &lt;- camera(cpm(norm$normalizedCounts, log = TRUE), 
               gsAnnots$h@idx, design, contrast = 2, trend.var = TRUE)
head(hCam, n = 20)</code></pre>
<pre><code>                                   NGenes Direction       PValue          FDR
HALLMARK_INTERFERON_ALPHA_RESPONSE     81        Up 2.406322e-46 1.203161e-44
HALLMARK_INTERFERON_GAMMA_RESPONSE    147        Up 5.488726e-30 1.372182e-28
HALLMARK_E2F_TARGETS                  196      Down 3.429932e-11 5.716553e-10
HALLMARK_MYC_TARGETS_V1               198      Down 3.847175e-07 4.808968e-06
HALLMARK_G2M_CHECKPOINT               194      Down 9.179905e-07 9.179905e-06
HALLMARK_TNFA_SIGNALING_VIA_NFKB      162        Up 1.668633e-06 1.390528e-05
HALLMARK_INFLAMMATORY_RESPONSE        116        Up 2.403865e-06 1.717046e-05
HALLMARK_IL6_JAK_STAT3_SIGNALING       47        Up 2.432785e-05 1.520491e-04
HALLMARK_KRAS_SIGNALING_UP            133        Up 6.152943e-05 3.418301e-04
HALLMARK_MITOTIC_SPINDLE              192      Down 1.023657e-04 5.118287e-04
HALLMARK_COMPLEMENT                   140        Up 2.342297e-04 1.064680e-03
HALLMARK_ALLOGRAFT_REJECTION          102        Up 1.145769e-03 4.774039e-03
HALLMARK_XENOBIOTIC_METABOLISM        139        Up 1.009094e-02 3.881132e-02
HALLMARK_MYC_TARGETS_V2                54      Down 1.308009e-02 4.671462e-02
HALLMARK_ADIPOGENESIS                 182        Up 2.598614e-02 8.662048e-02
HALLMARK_IL2_STAT5_SIGNALING          142        Up 2.789494e-02 8.717168e-02
HALLMARK_P53_PATHWAY                  180        Up 3.083296e-02 8.718515e-02
HALLMARK_COAGULATION                   84        Up 3.138665e-02 8.718515e-02
HALLMARK_TGF_BETA_SIGNALING            52        Up 4.110544e-02 1.081722e-01
HALLMARK_SPERMATOGENESIS               68      Down 4.658228e-02 1.150502e-01</code></pre>
<p>Barcode plots show the enrichment of gene sets among up or down-regulated genes. The following barcode plots show the enrichment of the top 4 hallmark gene sets among the genes differentially expressed between CMV positive and CMV negative samples.</p>
<pre class="r"><code>par(mfrow=c(2,2))
sapply(1:4, function(i){
  barcodeplot(lrt$table$logFC, gsAnnots$h@idx[[rownames(hCam)[i]]], 
              main = rownames(hCam)[i], cex.main = 0.75)
})</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-21-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-21-1">
Past versions of unnamed-chunk-21-1.png
</button>
</p>
<div id="fig-unnamed-chunk-21-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-21-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre><code>[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL</code></pre>
<p>The curated gene sets are compiled from online pathway databases, publications in PubMed, and knowledge of domain experts.</p>
<pre class="r"><code>c2Cam &lt;- camera(cpm(norm$normalizedCounts, log = TRUE), 
                gsAnnots$c2@idx, design, contrast = 2, trend.var = TRUE)
write.csv(c2Cam[c2Cam$FDR &lt; 0.05,], 
          file = here(&quot;output/star-fc-ruv-all-gsea-c2.csv&quot;))
head(c2Cam, n = 20)</code></pre>
<pre><code>                                                  NGenes Direction       PValue
MOSERLE_IFNA_RESPONSE                                 27        Up 1.516967e-39
BROWNE_INTERFERON_RESPONSIVE_GENES                    55        Up 1.246524e-37
HECKER_IFNB1_TARGETS                                  59        Up 6.933020e-33
SANA_RESPONSE_TO_IFNG_UP                              48        Up 7.638648e-33
DAUER_STAT3_TARGETS_DN                                49        Up 2.512081e-26
FARMER_BREAST_CANCER_CLUSTER_1                        15        Up 2.572179e-26
BOSCO_INTERFERON_INDUCED_ANTIVIRAL_MODULE             59        Up 5.242782e-25
EINAV_INTERFERON_SIGNATURE_IN_CANCER                  24        Up 1.176125e-23
BOWIE_RESPONSE_TO_TAMOXIFEN                           16        Up 1.011723e-21
SANA_TNF_SIGNALING_UP                                 63        Up 1.456173e-21
REACTOME_INTERFERON_ALPHA_BETA_SIGNALING              44        Up 2.904207e-21
BOWIE_RESPONSE_TO_EXTRACELLULAR_MATRIX                16        Up 9.206406e-21
BENNETT_SYSTEMIC_LUPUS_ERYTHEMATOSUS                  24        Up 1.626105e-20
RADAEVA_RESPONSE_TO_IFNA1_UP                          45        Up 1.793889e-20
ZHANG_INTERFERON_RESPONSE                             18        Up 1.496721e-18
DER_IFN_ALPHA_RESPONSE_UP                             67        Up 2.137283e-18
KRASNOSELSKAYA_ILF3_TARGETS_UP                        30        Up 8.179429e-17
SEITZ_NEOPLASTIC_TRANSFORMATION_BY_8P_DELETION_UP     56        Up 6.939545e-16
ZHU_CMV_8_HR_UP                                       40        Up 3.488281e-15
TAKEDA_TARGETS_OF_NUP98_HOXA9_FUSION_3D_UP           129        Up 7.223615e-15
                                                           FDR
MOSERLE_IFNA_RESPONSE                             5.674975e-36
BROWNE_INTERFERON_RESPONSIVE_GENES                2.331623e-34
HECKER_IFNB1_TARGETS                              7.144045e-30
SANA_RESPONSE_TO_IFNG_UP                          7.144045e-30
DAUER_STAT3_TARGETS_DN                            1.603754e-23
FARMER_BREAST_CANCER_CLUSTER_1                    1.603754e-23
BOSCO_INTERFERON_INDUCED_ANTIVIRAL_MODULE         2.801893e-22
EINAV_INTERFERON_SIGNATURE_IN_CANCER              5.499856e-21
BOWIE_RESPONSE_TO_TAMOXIFEN                       4.205397e-19
SANA_TNF_SIGNALING_UP                             5.447544e-19
REACTOME_INTERFERON_ALPHA_BETA_SIGNALING          9.876944e-19
BOWIE_RESPONSE_TO_EXTRACELLULAR_MATRIX            2.870097e-18
BENNETT_SYSTEMIC_LUPUS_ERYTHEMATOSUS              4.679430e-18
RADAEVA_RESPONSE_TO_IFNA1_UP                      4.793527e-18
ZHANG_INTERFERON_RESPONSE                         3.732823e-16
DER_IFN_ALPHA_RESPONSE_UP                         4.997235e-16
KRASNOSELSKAYA_ILF3_TARGETS_UP                    1.799955e-14
SEITZ_NEOPLASTIC_TRANSFORMATION_BY_8P_DELETION_UP 1.442269e-13
ZHU_CMV_8_HR_UP                                   6.868243e-13
TAKEDA_TARGETS_OF_NUP98_HOXA9_FUSION_3D_UP        1.351177e-12</code></pre>
<p>The following barcode plots show the enrichment of the top 4 curated gene sets among the genes differentially expressed between CMV positive and CMV negative samples.</p>
<pre class="r"><code>par(mfrow=c(2,2))
sapply(1:4, function(i){
  barcodeplot(lrt$table$logFC, gsAnnots$c2@idx[[rownames(c2Cam)[i]]], 
              main = rownames(c2Cam)[i], cex.main = 0.75)
})</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-23-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-23-1">
Past versions of unnamed-chunk-23-1.png
</button>
</p>
<div id="fig-unnamed-chunk-23-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-23-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre><code>[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL</code></pre>
<p>The KEGG gene sets encompass all of the pathways defined in the <a href="https://www.genome.jp/kegg/pathway.html">Kegg pathway database</a>.</p>
<pre class="r"><code>keggCam &lt;- camera(cpm(norm$normalizedCounts, log = TRUE), 
                  gsAnnots$kegg@idx, design, contrast = 2,
                  trend.var = TRUE)
head(keggCam, n = 20)</code></pre>
<pre><code>                                       NGenes Direction       PValue
Mineral absorption                         36        Up 1.610996e-09
Type I diabetes mellitus                   12        Up 5.757472e-07
Antigen processing and presentation        39        Up 6.116985e-07
Fat digestion and absorption               21        Up 7.875436e-07
Graft-versus-host disease                   8        Up 3.845748e-06
Hepatitis C                                98        Up 5.251118e-06
Cytokine-cytokine receptor interaction     83        Up 8.146892e-06
Autoimmune thyroid disease                 10        Up 1.425005e-05
Allograft rejection                         9        Up 2.050983e-05
NOD-like receptor signaling pathway       117        Up 2.719493e-05
Spliceosome                               128      Down 3.902381e-05
N-Glycan biosynthesis                      43        Up 4.188361e-05
Vitamin digestion and absorption           19        Up 4.223115e-05
Mismatch repair                            22      Down 7.330810e-05
Lysosome                                  106        Up 7.369917e-05
Influenza A                               119        Up 1.142647e-04
Bile secretion                             34        Up 1.150673e-04
Measles                                    89        Up 1.208825e-04
DNA replication                            33      Down 1.522974e-04
Cell adhesion molecules (CAMs)             54        Up 1.703345e-04
                                                FDR
Mineral absorption                     4.687998e-07
Type I diabetes mellitus               5.729380e-05
Antigen processing and presentation    5.729380e-05
Fat digestion and absorption           5.729380e-05
Graft-versus-host disease              2.238225e-04
Hepatitis C                            2.546792e-04
Cytokine-cytokine receptor interaction 3.386779e-04
Autoimmune thyroid disease             5.183456e-04
Allograft rejection                    6.631511e-04
NOD-like receptor signaling pathway    7.913725e-04
Spliceosome                            9.453280e-04
N-Glycan biosynthesis                  9.453280e-04
Vitamin digestion and absorption       9.453280e-04
Mismatch repair                        1.429764e-03
Lysosome                               1.429764e-03
Influenza A                            1.954267e-03
Bile secretion                         1.954267e-03
Measles                                1.954267e-03
DNA replication                        2.332555e-03
Cell adhesion molecules (CAMs)         2.478367e-03</code></pre>
<pre class="r"><code>par(mfrow=c(2,2))
sapply(1:4, function(i){
  barcodeplot(lrt$table$logFC, gsAnnots$kegg@idx[[rownames(keggCam)[i]]], 
              main = rownames(keggCam)[i], cex.main = 0.75)
})</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-25-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-1">
Past versions of unnamed-chunk-25-1.png
</button>
</p>
<div id="fig-unnamed-chunk-25-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-25-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre><code>[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL</code></pre>
</div>
<div id="brain-development-genes" class="section level1">
<h1>Brain development genes</h1>
<p>Test only the specialised brain development gene set.</p>
<pre class="r"><code>brainSet &lt;- readr::read_delim(file = here(&quot;data/brain-development-geneset.txt&quot;),
                              delim = &quot;\t&quot;, skip = 2, col_names = &quot;BRAIN_DEV&quot;)
brainSet</code></pre>
<pre><code># A tibble: 51 x 1
   BRAIN_DEV 
   &lt;chr&gt;     
 1 AC139768.1
 2 ADGRG1    
 3 AFF2      
 4 ALK       
 5 ALX1      
 6 BPTF      
 7 CDK5R1    
 8 CEP290    
 9 CLN5      
10 CNTN4     
# … with 41 more rows</code></pre>
<pre class="r"><code>bd &lt;- estimateGLMCommonDisp(y[y$genes$symbol %in% brainSet$BRAIN_DEV, ], design)
bd &lt;- estimateGLMTagwiseDisp(bd, design)
fit &lt;- glmFit(bd, design)
lrt &lt;- glmLRT(fit, coef = 2)
fitSum &lt;- summary(decideTests(lrt, p.value = 0.05))
fitSum</code></pre>
<pre><code>       CMV_status
Down            1
NotSig         26
Up              0</code></pre>
<pre class="r"><code>topBD &lt;- topTags(lrt, n = Inf)$table
topBD</code></pre>
<pre><code>                  Geneid Length         Ensembl  symbol entrezid        logFC
54718 ENSG00000053438.11   1329 ENSG00000053438    NNAT     4826 -0.660321228
47853  ENSG00000176749.9   3948 ENSG00000176749  CDK5R1     8851  0.266990157
46775 ENSG00000040531.16   4949 ENSG00000040531    CTNS     1497  0.226446331
59499 ENSG00000102038.15   4363 ENSG00000102038 SMARCA1     6594 -0.168383655
45778 ENSG00000205336.13   8659 ENSG00000205336  ADGRG1     9289  0.224428395
58386 ENSG00000158352.15  10333 ENSG00000158352 SHROOM4    57477  0.095044294
33637 ENSG00000110697.13   6442 ENSG00000110697 PITPNM1     9600  0.134345216
10970 ENSG00000185008.17  16663 ENSG00000185008   ROBO2     6092 -0.155347930
3760  ENSG00000185630.19  21370 ENSG00000185630    PBX1     5087 -0.078888760
7681  ENSG00000074047.21   7341 ENSG00000074047    GLI2     2736 -0.147297363
37089 ENSG00000198707.16  10442 ENSG00000198707  CEP290    80184 -0.103458016
13911  ENSG00000132467.4   2020 ENSG00000132467    UTP3    57050  0.079435464
42132 ENSG00000114062.21  12808 ENSG00000114062   UBE3A     7337  0.043409657
59824 ENSG00000155966.14  14241 ENSG00000155966    AFF2     2334 -0.112142953
16275 ENSG00000164258.12   1174 ENSG00000164258  NDUFS4     4724  0.054771948
23659 ENSG00000128573.26  16334 ENSG00000128573   FOXP2    93986 -0.074926883
9697  ENSG00000144619.15   9123 ENSG00000144619   CNTN4   152330 -0.059042531
47791 ENSG00000196712.18  27130 ENSG00000196712     NF1     4763 -0.032140447
51917 ENSG00000130479.11   4933 ENSG00000130479   MAP1S    55201  0.037520138
57747 ENSG00000146950.13   8218 ENSG00000146950 SHROOM2      357 -0.024115264
39080 ENSG00000102805.16  22814 ENSG00000102805    CLN5     1203 -0.029818655
2823  ENSG00000092621.12   9217 ENSG00000092621   PHGDH    26227  0.031690508
24536  ENSG00000164690.8   5234 ENSG00000164690     SHH     6469  0.028604977
1293  ENSG00000131238.17   5088 ENSG00000131238    PPT1     5538  0.013587601
49155 ENSG00000171634.18  15119 ENSG00000171634    BPTF     2186 -0.008428348
28963 ENSG00000167081.18   4904 ENSG00000167081    PBX3     5090  0.010594881
54624 ENSG00000198646.14  11133 ENSG00000198646   NCOA6    23054 -0.003680951
        logCPM           LR       PValue         FDR
54718 6.823447 16.738118275 4.291014e-05 0.001158574
47853 3.961239  2.993631993 8.359249e-02 0.959243167
46775 2.886082  2.357949224 1.246460e-01 0.959243167
59499 7.435227  1.679359575 1.950096e-01 0.959243167
45778 4.487531  1.659694591 1.976446e-01 0.959243167
58386 5.420720  0.988830785 3.200283e-01 0.959243167
33637 5.388541  0.955275608 3.283801e-01 0.959243167
10970 3.995737  0.891791209 3.449924e-01 0.959243167
3760  8.695596  0.748535365 3.869403e-01 0.959243167
7681  2.350163  0.675304935 4.112082e-01 0.959243167
37089 6.738311  0.581460223 4.457405e-01 0.959243167
13911 4.964853  0.536041714 4.640778e-01 0.959243167
42132 7.720255  0.346348698 5.561874e-01 0.959243167
59824 1.889596  0.301986579 5.826397e-01 0.959243167
16275 4.867642  0.255776167 6.130369e-01 0.959243167
23659 6.031793  0.205700418 6.501584e-01 0.959243167
9697  2.553732  0.118168613 7.310293e-01 0.959243167
47791 7.822985  0.117429764 7.318390e-01 0.959243167
51917 4.816698  0.106828675 7.437839e-01 0.959243167
57747 5.891511  0.071056296 7.898050e-01 0.959243167
39080 3.552256  0.051663157 8.201941e-01 0.959243167
2823  4.107238  0.049314881 8.242597e-01 0.959243167
24536 3.482613  0.035804872 8.499190e-01 0.959243167
1293  4.260414  0.011925231 9.130417e-01 0.959243167
49155 9.113674  0.009409434 9.227246e-01 0.959243167
28963 4.824794  0.005441858 9.411942e-01 0.959243167
54624 7.391416  0.002611552 9.592432e-01 0.959243167</code></pre>
<p>The following plots show the expression of the top 9 genes from the brain development set as ranked by their differential expression with regard to CMV positive and CMV negative status.</p>
<pre class="r"><code>b &lt;- norm$normalizedCounts[y$genes$entrezid %in% topBD$entrezid[1:9], ]
dat &lt;- reshape2::melt(cpm(b, log = TRUE),
                      value.name = &quot;cpm&quot;)
dat$status &lt;- rep(targets$CMV_status, each = nrow(b))
dat$gene &lt;- rep(y$genes$Geneid[y$genes$entrezid %in% topBD$entrezid[1:9]], 
                ncol(b))

p &lt;- vector(&quot;list&quot;, 9)

for(i in 1:length(p)){
p[[i]] &lt;- ggplot(data = subset(dat, dat$gene == topBD$Geneid[i]), 
       aes(x = status, y = cpm, colour = status)) +
  geom_jitter(width = 0.25) +
  stat_summary(fun = &quot;mean&quot;, geom = &quot;crossbar&quot;) +
  labs(x = &quot;Status&quot;, y = &quot;log2 CPM&quot;, colour = &quot;Status&quot;) +
  ggtitle(topBD$symbol[i]) +
  theme(plot.title = element_text(size = 8),
        plot.subtitle = element_text(size = 7),
        axis.title = element_text(size = 8),
        axis.text.x = element_text(size = 7))
}

wrap_plots(p, guides = &quot;collect&quot;, ncol = 3) &amp; 
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-29-1">
Past versions of unnamed-chunk-29-1.png
</button>
</p>
<div id="fig-unnamed-chunk-29-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/77ba079a747c0de04c91e94e3129beb7d7c4ee4b/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-29-1.png" target="_blank">77ba079</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2021-09-25
</td>
</tr>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/amnio-cell-free-rna/blob/d96660bec01347bcec29e84c1c4313e95abc8d04/docs/figure/STAR-FC-RUV-all.Rmd/unnamed-chunk-29-1.png" target="_blank">d96660b</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2020-11-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="compare-to-limma-voom-analysis" class="section level1">
<h1>Compare to limma-voom analysis</h1>
<pre class="r"><code>limma &lt;- read.csv(file = here(&quot;output/star-fc-limma-voom-all.csv&quot;))
ruv &lt;- read.csv(file = here(&quot;output/star-fc-ruv-all.csv&quot;))

sig &lt;- length(intersect(limma$symbol[limma$adj.P.Val &lt; 0.05], ruv$symbol[ruv$FDR &lt; 0.05]))
tot &lt;- length(intersect(limma$symbol, ruv$symbol))
first &lt;- min(which(!ruv$symbol[ruv$FDR &lt; 0.05] %in% limma$symbol[limma$adj.P.Val &lt; 0.05]))
not &lt;- sum(!ruv$symbol[ruv$FDR &lt; 0.05] %in% limma$symbol)</code></pre>
<p>There were 190 significant genes overlapping between the <em>RUVseq</em> and <em>limma</em> analyses. There were 373 genes overlapping between the top 500 genes as ranked by p-value by both analyses. The top ranked 78 genes from the <em>RUVseq</em> analysis are also ranked in the top 78 genes by the <code>limma</code> analysis. There are only 45 genes that are statistically significant in the <em>RUVseq</em> analysis that are not in the top 500 ranked genes of the <em>limma</em> analysis.</p>
<p>The genes that are significant in the <em>RUVseq</em> analysis but not ranked in the top 500 <em>limma</em> genes are overrepresented in GO categories such as immune system process, immune response, response to external biotic stimulus etc. suggesting that they are still relevant to the biology of CMV infection.</p>
<pre class="r"><code>go &lt;- goana(ruv$entrezid[!ruv$symbol[ruv$FDR &lt; 0.05] %in% limma$symbol], 
            universe = y$genes$entrezid, 
            trend = y$genes$Length)
topGO(go) %&gt;% mutate(FDR = p.adjust(P.DE)) %&gt;% knitr::kable()</code></pre>
<table>
<colgroup>
<col width="12%" />
<col width="50%" />
<col width="4%" />
<col width="5%" />
<col width="3%" />
<col width="10%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Term</th>
<th align="left">Ont</th>
<th align="right">N</th>
<th align="right">DE</th>
<th align="right">P.DE</th>
<th align="right">FDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="GO:0002376" class="uri">GO:0002376</a></td>
<td align="left">immune system process</td>
<td align="left">BP</td>
<td align="right">1887</td>
<td align="right">24</td>
<td align="right">0.00e+00</td>
<td align="right">0.0000009</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0006955" class="uri">GO:0006955</a></td>
<td align="left">immune response</td>
<td align="left">BP</td>
<td align="right">1177</td>
<td align="right">19</td>
<td align="right">1.00e-07</td>
<td align="right">0.0000011</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0043207" class="uri">GO:0043207</a></td>
<td align="left">response to external biotic stimulus</td>
<td align="left">BP</td>
<td align="right">849</td>
<td align="right">16</td>
<td align="right">1.00e-07</td>
<td align="right">0.0000020</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0051707" class="uri">GO:0051707</a></td>
<td align="left">response to other organism</td>
<td align="left">BP</td>
<td align="right">849</td>
<td align="right">16</td>
<td align="right">1.00e-07</td>
<td align="right">0.0000020</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0009607" class="uri">GO:0009607</a></td>
<td align="left">response to biotic stimulus</td>
<td align="left">BP</td>
<td align="right">876</td>
<td align="right">16</td>
<td align="right">2.00e-07</td>
<td align="right">0.0000027</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0002252" class="uri">GO:0002252</a></td>
<td align="left">immune effector process</td>
<td align="left">BP</td>
<td align="right">776</td>
<td align="right">14</td>
<td align="right">1.40e-06</td>
<td align="right">0.0000211</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0045087" class="uri">GO:0045087</a></td>
<td align="left">innate immune response</td>
<td align="left">BP</td>
<td align="right">516</td>
<td align="right">11</td>
<td align="right">4.90e-06</td>
<td align="right">0.0000687</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0006952" class="uri">GO:0006952</a></td>
<td align="left">defense response</td>
<td align="left">BP</td>
<td align="right">913</td>
<td align="right">14</td>
<td align="right">9.40e-06</td>
<td align="right">0.0001226</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0034340" class="uri">GO:0034340</a></td>
<td align="left">response to type I interferon</td>
<td align="left">BP</td>
<td align="right">74</td>
<td align="right">5</td>
<td align="right">1.12e-05</td>
<td align="right">0.0001345</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0031410" class="uri">GO:0031410</a></td>
<td align="left">cytoplasmic vesicle</td>
<td align="left">CC</td>
<td align="right">1692</td>
<td align="right">19</td>
<td align="right">1.48e-05</td>
<td align="right">0.0001623</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0097708" class="uri">GO:0097708</a></td>
<td align="left">intracellular vesicle</td>
<td align="left">CC</td>
<td align="right">1695</td>
<td align="right">19</td>
<td align="right">1.51e-05</td>
<td align="right">0.0001623</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0044419" class="uri">GO:0044419</a></td>
<td align="left">interspecies interaction between organisms</td>
<td align="left">BP</td>
<td align="right">1439</td>
<td align="right">17</td>
<td align="right">2.61e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0002443" class="uri">GO:0002443</a></td>
<td align="left">leukocyte mediated immunity</td>
<td align="left">BP</td>
<td align="right">509</td>
<td align="right">10</td>
<td align="right">2.86e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0006959" class="uri">GO:0006959</a></td>
<td align="left">humoral immune response</td>
<td align="left">BP</td>
<td align="right">90</td>
<td align="right">5</td>
<td align="right">2.91e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0012505" class="uri">GO:0012505</a></td>
<td align="left">endomembrane system</td>
<td align="left">CC</td>
<td align="right">3271</td>
<td align="right">27</td>
<td align="right">3.08e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0098542" class="uri">GO:0098542</a></td>
<td align="left">defense response to other organism</td>
<td align="left">BP</td>
<td align="right">628</td>
<td align="right">11</td>
<td align="right">3.11e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0019730" class="uri">GO:0019730</a></td>
<td align="left">antimicrobial humoral response</td>
<td align="left">BP</td>
<td align="right">48</td>
<td align="right">4</td>
<td align="right">3.95e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0005887" class="uri">GO:0005887</a></td>
<td align="left">integral component of plasma membrane</td>
<td align="left">CC</td>
<td align="right">667</td>
<td align="right">11</td>
<td align="right">5.40e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="odd">
<td align="left"><a href="GO:0140352" class="uri">GO:0140352</a></td>
<td align="left">export from cell</td>
<td align="left">BP</td>
<td align="right">947</td>
<td align="right">13</td>
<td align="right">6.77e-05</td>
<td align="right">0.0002350</td>
</tr>
<tr class="even">
<td align="left"><a href="GO:0031982" class="uri">GO:0031982</a></td>
<td align="left">vesicle</td>
<td align="left">CC</td>
<td align="right">2804</td>
<td align="right">24</td>
<td align="right">6.83e-05</td>
<td align="right">0.0002350</td>
</tr>
</tbody>
</table>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Although the effective library sizes were low, the data is generally of good quality. We found at total of 341 differentially expressed genes at FDR &lt; 0.05. The significant genes were enriched for GO terms associated with interferon response and similar. Further gene set testing results indicate an upregulation of interferon response genes in the CMV positive samples, relative to the CMV negative samples, which is consistent with the top genes from the DE analysis.</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS:   /config/binaries/R/4.0.2/lib64/R/lib/libRblas.so
LAPACK: /config/binaries/R/4.0.2/lib64/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats4    parallel  stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] RColorBrewer_1.1-2          RUVSeq_1.24.0              
 [3] EDASeq_2.24.0               ShortRead_1.48.0           
 [5] GenomicAlignments_1.26.0    SummarizedExperiment_1.20.0
 [7] MatrixGenerics_1.2.1        matrixStats_0.59.0         
 [9] Rsamtools_2.6.0             Biostrings_2.58.0          
[11] XVector_0.30.0              BiocParallel_1.24.1        
[13] EGSEA_1.18.1                pathview_1.30.1            
[15] topGO_2.42.0                SparseM_1.78               
[17] GO.db_3.12.1                graph_1.68.0               
[19] gage_2.40.1                 patchwork_1.1.1            
[21] NMF_0.23.0                  cluster_2.1.0              
[23] rngtools_1.5                pkgmaker_0.32.2            
[25] registry_0.5-1              edgeR_3.32.1               
[27] limma_3.46.0                EnsDb.Hsapiens.v86_2.99.0  
[29] ensembldb_2.14.0            AnnotationFilter_1.14.0    
[31] GenomicFeatures_1.42.1      AnnotationDbi_1.52.0       
[33] Biobase_2.50.0              GenomicRanges_1.42.0       
[35] GenomeInfoDb_1.26.7         IRanges_2.24.1             
[37] S4Vectors_0.28.1            BiocGenerics_0.36.1        
[39] forcats_0.5.1               stringr_1.4.0              
[41] dplyr_1.0.4                 purrr_0.3.4                
[43] readr_1.4.0                 tidyr_1.1.2                
[45] tibble_3.1.2                ggplot2_3.3.5              
[47] tidyverse_1.3.0             here_1.0.1                 
[49] workflowr_1.6.2            

loaded via a namespace (and not attached):
  [1] rappdirs_0.3.3           rtracklayer_1.50.0       Glimma_2.0.0            
  [4] R.methodsS3_1.8.1        bit64_4.0.5              knitr_1.31              
  [7] R.utils_2.10.1           aroma.light_3.20.0       multcomp_1.4-16         
 [10] DelayedArray_0.16.3      data.table_1.13.6        hwriter_1.3.2           
 [13] KEGGREST_1.30.1          RCurl_1.98-1.3           doParallel_1.0.16       
 [16] generics_0.1.0           metap_1.4                org.Mm.eg.db_3.12.0     
 [19] TH.data_1.0-10           RSQLite_2.2.5            bit_4.0.4               
 [22] mutoss_0.1-12            xml2_1.3.2               lubridate_1.7.9.2       
 [25] httpuv_1.5.5             assertthat_0.2.1         xfun_0.23               
 [28] hms_1.0.0                evaluate_0.14            promises_1.2.0.1        
 [31] fansi_0.5.0              progress_1.2.2           caTools_1.18.1          
 [34] dbplyr_2.1.0             readxl_1.3.1             Rgraphviz_2.34.0        
 [37] DBI_1.1.1                geneplotter_1.68.0       tmvnsim_1.0-2           
 [40] htmlwidgets_1.5.3        ellipsis_0.3.2           backports_1.2.1         
 [43] annotate_1.68.0          PADOG_1.32.0             gbRd_0.4-11             
 [46] gridBase_0.4-7           biomaRt_2.46.3           HTMLUtils_0.1.7         
 [49] vctrs_0.3.8              cachem_1.0.4             withr_2.4.2             
 [52] globaltest_5.44.0        prettyunits_1.1.1        mnormt_2.0.2            
 [55] lazyeval_0.2.2           crayon_1.4.1             genefilter_1.72.1       
 [58] labeling_0.4.2           pkgconfig_2.0.3          nlme_3.1-152            
 [61] ProtGenerics_1.22.0      GSA_1.03.1               rlang_0.4.11            
 [64] lifecycle_1.0.0          sandwich_3.0-0           BiocFileCache_1.14.0    
 [67] mathjaxr_1.2-0           modelr_0.1.8             cellranger_1.1.0        
 [70] rprojroot_2.0.2          GSVA_1.38.2              Matrix_1.3-2            
 [73] zoo_1.8-9                reprex_1.0.0             whisker_0.4             
 [76] png_0.1-7                viridisLite_0.4.0        bitops_1.0-7            
 [79] R.oo_1.24.0              KernSmooth_2.23-18       blob_1.2.1              
 [82] R2HTML_2.3.2             doRNG_1.8.2              jpeg_0.1-8.1            
 [85] scales_1.1.1             memoise_2.0.0.9000       GSEABase_1.52.1         
 [88] magrittr_2.0.1           plyr_1.8.6               safe_3.30.0             
 [91] gplots_3.1.1             zlibbioc_1.36.0          compiler_4.0.2          
 [94] plotrix_3.8-1            KEGGgraph_1.50.0         DESeq2_1.30.1           
 [97] cli_3.0.0                EGSEAdata_1.18.0         MASS_7.3-53.1           
[100] tidyselect_1.1.0         stringi_1.5.3            highr_0.8               
[103] yaml_2.2.1               askpass_1.1              locfit_1.5-9.4          
[106] latticeExtra_0.6-29      grid_4.0.2               tools_4.0.2             
[109] rstudioapi_0.13          foreach_1.5.1            git2r_0.28.0            
[112] farver_2.1.0             digest_0.6.27            Rcpp_1.0.6              
[115] broom_0.7.4              later_1.1.0.1            org.Hs.eg.db_3.12.0     
[118] httr_1.4.2               Rdpack_2.1               colorspace_2.0-2        
[121] rvest_0.3.6              XML_3.99-0.5             fs_1.5.0                
[124] splines_4.0.2            sn_1.6-2                 multtest_2.46.0         
[127] plotly_4.9.3             xtable_1.8-4             jsonlite_1.7.2          
[130] R6_2.5.0                 TFisher_0.2.0            KEGGdzPathwaysGEO_1.28.0
[133] pillar_1.6.1             htmltools_0.5.1.1        hgu133plus2.db_3.2.3    
[136] glue_1.4.2               fastmap_1.1.0            DT_0.17                 
[139] codetools_0.2-18         mvtnorm_1.1-1            utf8_1.2.1              
[142] lattice_0.20-41          numDeriv_2016.8-1.1      hgu133a.db_3.2.3        
[145] curl_4.3                 gtools_3.8.2             openssl_1.4.3           
[148] survival_3.2-7           rmarkdown_2.6            org.Rn.eg.db_3.12.0     
[151] munsell_0.5.0            GenomeInfoDbData_1.2.4   iterators_1.0.13        
[154] haven_2.3.1              reshape2_1.4.4           gtable_0.3.0            
[157] rbibutils_2.0           </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
